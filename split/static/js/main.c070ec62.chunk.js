(this.webpackJsonpsplit=this.webpackJsonpsplit||[]).push([[0],{352:function(e,t){},354:function(e,t){},364:function(e,t){},366:function(e,t){},391:function(e,t){},392:function(e,t){},397:function(e,t){},399:function(e,t){},406:function(e,t){},425:function(e,t){},520:function(e,t,n){},522:function(e,t,n){"use strict";n.r(t);var a=n(0),i=n.n(a),c=n(37),r=n.n(c),s=n(29),o=n(9),l=n(21),d=n(22),p=n(25),h=n(23),u=n(48),g=n(73),b=n.n(g),j=n(310),f=n(314),m=n(80),x=n(82),v=n(67),O=n(40),y=n(311),w=n(1),C=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.icon,n=e.color,a=e.style,i=e.className;return Object(w.jsx)("i",{className:"iconfont icon-".concat(t," ").concat(i||""),style:Object(o.a)(Object(o.a)({},a),{},{color:n})})}}]),n}(a.PureComponent),k=C,I=n(192),S=n(301),N={env:"default",mode:"choose",trackProjectId:"",scale:1,dataMap:{id:"0",name:"newProject",cname:"\u65b0\u5efa\u9879\u76ee",willCreateKey:1,channel:{},bc:{image:"",scale:1},children:[]},activeId:"0",editId:"",parentId:"",settingWidth:600,isFreeze:!1,extraSetting:{isShowText:!0}},T=n(87),z=n(298),M=n.n(z),D=n(157),A=n.n(D),E=function(e){for(var t=P(),n=t.length-1;n>=0;n--){var a=t[n];if(_(e,Object(o.a)({},a.getBounds())))return a}},_=function(e,t){return Boolean(e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height)},P=function(e){var t=window.app;return e?t.stage.children.filter((function(t){return/^\d+(_\d)*$/g.test(t.name)&&0===(t.name+"_").indexOf(e.name+"_")&&e.name!==t.name})):t.stage.children.filter((function(e){return/^\d+(_\d)*$/g.test(e.name)}))},L=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:X.getState().dataMap;if(n.id===t)return n;for(var a=0;a<n.children.length;a++)if(1===t.split("_").length){if(t===n.children[a].id)return e(t,n.children[a])}else if(0===t.indexOf(n.children[a].id+"_")||t===n.children[a].id)return e(t,n.children[a])},F=function(){var e=window.app;q("choose"),Z(""),e.stage.cursor="default",e.stage.removeAllListeners();var t=e.stage.children.find((function(e){return!!e.isHit}));t&&(t.filters=[]),P().forEach((function(e,t){e.cursor="move",e.removeAllListeners(),e.interactive=!0,e.on("pointerdown",(function(t){if(0===t.data.button){var n=X.getState(),a=n.scale,i=n.dataMap,c=!0,r=Object(o.a)({},t.data.global),s=r.x,l=r.y,d=Object(o.a)({},i),p=L(e.name,d);p&&(Q(e.name),e.on("pointermove",(function(t){if(c){var n=Object(o.a)({},t.data.global),i=n.x,r=n.y;if(e.x+=(i-s)/a,e.y+=(r-l)/a,p.x=e.x,p.y=e.y,!t.data.originalEvent.metaKey){var h=P(e);if(h.length>0)for(var u=0;u<h.length;u++){h[u].x+=(i-s)/a,h[u].y+=(r-l)/a;var g=L(h[u].name,d);g.x=h[u].x,g.y=h[u].y}}ce(d),s=i,l=r}})),e.on("pointerup",(function(){c=!1})),e.on("pointerupoutside",(function(){c=!1})))}}))}))},B=function(e,t){var n=window.app,a=X.getState().scale;if(!e||e.metaKey){var i=n.stage,c=i.x,r=i.y,s=t||Number((a+e.wheelDeltaY/120/100).toFixed(2));s<=4&&s>=.1&&(n.stage.setTransform(c,r,s,s),n.stage.hitArea.x=-n.stage.x/s,n.stage.hitArea.y=-n.stage.y/s,n.stage.hitArea.width=n.view.width/s,n.stage.hitArea.height=n.view.height/s,Y(s))}},K=function(e){return parseInt(e.replace("#","0x"),16)},R=function(e,t){var n=document.createElement("input");n.setAttribute("id","cp_input"),n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n),t&&t(e)},W=function(e){var t=M.a.createHash("md5");return t.update(e||"","utf8"),t.digest("hex")},U=function(e){var t=X.getState().extraSetting,n=window.app,a={};if("string"===typeof e)try{a=new Function("return ".concat(e))()}catch(d){try{a=JSON.parse(e)}catch(d){return void j.b.error("\u8f6c\u6362\u5931\u8d25\uff1a".concat(d))}}else a=e;try{Q(""),ce(a);var i,c=Object(T.a)(window.app.stage.children.filter((function(e){return"bc"!==e.name&&"point"!==e.name})));try{for(c.s();!(i=c.n()).done;){var r=i.value;window.app.stage.removeChild(r)}}catch(p){c.e(p)}finally{c.f()}if(a.bc.image){var s,o=u.f.from(a.bc.image),l=new u.d(o);l.name="bc",l.zIndex=-1,l.setTransform(0,0,a.bc.scale,a.bc.scale),(s=window.app.stage).removeChild.apply(s,Object(O.a)(n.stage.children.filter((function(e){return"bc"===e.name})))),n.stage.addChild(l)}!function e(n){if(n.children.length>0){var a,i=Object(T.a)(n.children);try{for(i.s();!(a=i.n()).done;){var c=a.value,r={fontFamily:"Arial",fontSize:"13px",fontWeight:"bold",fill:c.color,stroke:A()(c.color).isLight()?"rgba(0, 0, 0, 0.7)":"rgba(255, 255, 255, 0.7)",strokeThickness:4,dropShadow:!0,dropShadowColor:"#cccccc",dropShadowAngle:Math.PI/6,dropShadowDistance:2,dropShadowBlur:4,wordWrap:!0,wordWrapWidth:440},s=new u.b,o=K(c.color);s.name=c.id,s.lineStyle(4,o,1),s.beginFill(o,.2),s.x=c.x,s.y=c.y,s.text=c.name,s.drawRect(0,0,c.width,c.height),s.endFill();var l=new u.e(s.text,r);l.name="text",l.x=0,l.y=-24,l.resolution=2,l.visible=t.isShowText,s.addChild(l),window.app.stage.addChild(s),e(c)}}catch(p){i.e(p)}finally{i.f()}}}(a),F(),j.b.success("\u7c98\u8d34\u6210\u529f\uff01")}catch(d){j.b.error("\u8f6c\u6362\u5931\u8d25: ".concat(d))}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X.getState().dataMap,t=[],n=function e(n){if(n.config&&n.config.chip&&n.config.chip.length>0&&n.config.chip.forEach((function(e){t.push(Object(o.a)(Object(o.a)({},e),{},{id:n.id}))})),n.children&&n.children.length>0)for(var a in n.children)e(n.children[a])};return n(e),t};var H,G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"change_env":return Object(o.a)(Object(o.a)({},e),{},{env:t.env});case"change_mode":return Object(o.a)(Object(o.a)({},e),{},{mode:t.mode});case"change_scale":return Object(o.a)(Object(o.a)({},e),{},{scale:t.scale});case"change_dataMap":return Object(o.a)(Object(o.a)({},e),{},{dataMap:t.dataMap});case"change_editId":return Object(o.a)(Object(o.a)({},e),{},{editId:t.editId});case"change_parentId":return Object(o.a)(Object(o.a)({},e),{},{parentId:t.parentId});case"change_settingWidth":return Object(o.a)(Object(o.a)({},e),{},{settingWidth:t.settingWidth});case"change_trackProjectId":return Object(o.a)(Object(o.a)({},e),{},{trackProjectId:t.trackProjectId});case"change_isFreeze":return Object(o.a)(Object(o.a)({},e),{},{isFreeze:t.isFreeze});case"change_extraSetting":return Object(o.a)(Object(o.a)({},e),{},{extraSetting:t.extraSetting});case"change_activeId":var n=window,a=n.app,i=t.activeId;return""!==i&&"0"!==i&&(a.stage.children.filter((function(e){return"bc"!==e.name&&"point"!==e.name})).forEach((function(e){return e.zIndex=0})),a.stage.children.find((function(e){return e.name===t.activeId})).zIndex=999),Object(o.a)(Object(o.a)({},e),{},{activeId:t.activeId});case"delete_data":for(var c=t.id.split("_"),r=c.length>1?c.slice(0,-1).join("_"):"0",s=Object(o.a)({},e.dataMap),l=L(r,s),d=0;d<l.children.length;d++)if(l.children[d].id===t.id){l.children.splice(d,1);break}return Object(o.a)(Object(o.a)({},e),{},{dataMap:s,activeId:"",mode:"choose"});case"drag_data":for(var p=t.obj,h=p.dropOver,u=p.originKey,g=p.targetKey,b=p.dropPosition,j=Object(o.a)({},e.dataMap),f=L(u[0],j),m=f.id.split("_").length>1?f.id.split("_").slice(0,-1).join("_"):"0",x=L(m,j),v=0;v<x.children.length;v++)if(x.children[v].id===u[0]){x.children.splice(v,1);break}if(h){var O=L(g,j),y="0"===O.id?O.willCreateKey+"":"".concat(O.id,"_").concat(O.willCreateKey),w=function e(t,n){if(window.app.stage.children.find((function(e){return e.name===t.id})).name=n,t.id=n,t.children)for(var a=0;a<t.children.length;a++){var i="".concat(t.id,"_").concat(t.willCreateKey);t.willCreateKey++,e(t.children[a],i)}};return w(f,y),O.children.push(f),O.willCreateKey++,Object(o.a)(Object(o.a)({},e),{},{activeId:f.id,dataMap:j})}var C=g.split("_").length>1?g.split("_").slice(0,-1).join("_"):"0",k=L(C,j),I="0"===k.id?k.willCreateKey+"":"".concat(k.id,"_").concat(k.willCreateKey),S=function e(t,n){if(window.app.stage.children.find((function(e){return e.name===t.id})).name=n,t.id=n,t.children)for(var a=0;a<t.children.length;a++){var i="0"===t.id?t.willCreateKey+"":"".concat(t.id,"_").concat(t.willCreateKey);t.willCreateKey++,e(t.children[a],i)}};S(f,I);for(var T=0;T<k.children.length;T++)if(k.children[T].id===g){if("top"===b){k.children.splice(T,0,f);break}k.children.splice(T+1,0,f);break}return k.willCreateKey++,Object(o.a)(Object(o.a)({},e),{},{activeId:f.id,dataMap:j});default:return e}},J=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||I.b,X=Object(I.c)(G,N,J(Object(I.a)(S.a))),$=function(e){return X.dispatch({type:"change_env",env:e})},q=function(e){return X.dispatch({type:"change_mode",mode:e})},Y=function(e){return X.dispatch({type:"change_scale",scale:e})},Q=function(e){return X.dispatch({type:"change_activeId",activeId:e})},Z=function(e){return X.dispatch({type:"change_editId",editId:e})},ee=function(e){return X.dispatch({type:"change_parentId",parentId:e})},te=function(e){return X.dispatch({type:"change_settingWidth",settingWidth:e})},ne=function(e){return X.dispatch({type:"change_trackProjectId",trackProjectId:e})},ae=function(e){return X.dispatch({type:"change_isFreeze",isFreeze:e})},ie=function(e){return X.dispatch({type:"change_extraSetting",extraSetting:e})},ce=function(e){return X.dispatch({type:"change_dataMap",dataMap:e})},re=function(e){return X.dispatch({type:"delete_data",id:e})},se=function(e){return X.dispatch({type:"drag_data",obj:e})},oe=n(30),le=n(31),de=le.a.span(H||(H=Object(oe.a)(["\n  .empty {\n    //animation: empty 1.5s infinite linear;\n  }\n  \n  button {\n    background-color: #eeeeee!important;\n    //pointer-events: none;\n    cursor: not-allowed!important;\n  }\n  \n  @keyframes empty {\n    from {\n      transform: rotate(0deg);\n    }\n    5% {\n      transform: rotate(-10deg);\n    }\n    10% {\n      transform: rotate(0deg);\n    }\n    15% {\n      transform: rotate(10deg);\n    }\n    20% {\n      transform: rotate(0deg);\n    }\n    25% {\n      transform: rotate(10deg);\n    }\n    30% {\n      transform: rotate(0deg);\n    }\n  }\n"]))),pe=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).upload=function(){},e.finishUpload=function(t){var n=window.app,a=Object(y.a)(t.currentTarget.files,1)[0],i=new FileReader;i.readAsDataURL(a),i.onload=function(t){b.a.post("https://test0.ucms.ifeng.com/api/resource/upload",{body:{data:t.target.result,needWaterMark:!1,position:"",waterMarkUrl:""}}).then((function(a){if(0===a.data.code){var i,c=u.f.from(t.target.result),r=new u.d(c);r.name="bc",r.zIndex=-1,(i=n.stage).removeChild.apply(i,Object(O.a)(n.stage.children.filter((function(e){return"bc"===e.name})))),n.stage.addChild(r);var s=e.props.dataMap,l=Object(o.a)({},s);l.bc.image=a.data.data.url,ce(l),j.b.success("\u4e0a\u4f20\u6210\u529f")}else j.b.error("\u4e0a\u4f20\u5931\u8d25\uff1a".concat(a.data.message))}))}},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props.dataMap.bc.image;return Object(w.jsxs)(de,{children:[Object(w.jsx)(x.a,{title:"\u4e0a\u4f20\u65b0\u7684\u80cc\u666f\u56fe(\u6682\u505c)",children:Object(w.jsx)("button",{className:"btn image ".concat(e?"":"empty"),onClick:this.upload,children:Object(w.jsx)(k,{icon:"addImage"})})}),Object(w.jsx)("input",{type:"file",accept:"image/*",id:"uploadImage",hidden:!0,onChange:this.finishUpload})]})}}]),n}(a.PureComponent);var he=Object(s.b)((function(e){return{dataMap:e.dataMap}}))(pe),ue=n(523),ge=n(531),be=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={isShowPasteInput:!1},e.paste=function(t){var n=e.state.isShowPasteInput;t.stopPropagation();var a=document.getElementById("pasteInput");n?(a.value&&U(a.value),e.setState({isShowPasteInput:!1})):navigator.clipboard?navigator.clipboard.readText().then((function(e){e?U(e):j.b.error("\u526a\u5207\u677f\u4e3a\u7a7a")})).catch((function(t){j.b.info("\u672a\u83b7\u53d6\u5230\u526a\u5207\u677f\u6743\u9650\uff0c\u8bf7\u624b\u52a8\u7c98\u8d34\u5230\u6587\u672c\u6846\u4e2d"),document.addEventListener("click",e.cancelPaste),e.setState({isShowPasteInput:!0}),a&&a.focus()})):(j.b.info("\u672a\u83b7\u53d6\u5230\u526a\u5207\u677f\u6743\u9650\uff0c\u8bf7\u624b\u52a8\u7c98\u8d34\u5230\u6587\u672c\u6846\u4e2d"),document.addEventListener("click",e.cancelPaste),e.setState({isShowPasteInput:!0}))},e.cancelPaste=function(t){document.getElementById("pasteInput")!==t.target&&(e.setState({isShowPasteInput:!1}),document.removeEventListener("click",e.cancelPaste))},e.handlePressEnter=function(t){U(t.target.value),e.setState({isShowPasteInput:!1})},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.state.isShowPasteInput;return Object(w.jsx)(ue.a,{visible:e,placement:"bottomRight",arrowPointAtCenter:!1,destroyTooltipOnHide:!0,content:Object(w.jsx)(ge.a,{id:"pasteInput",placeholder:"\u7c98\u8d34...",autoFocus:!0,style:{width:"240px"},onPressEnter:this.handlePressEnter}),children:Object(w.jsxs)(v.a,{className:"paste ".concat(e?"active":""),type:"primary",onClick:this.paste,children:[Object(w.jsx)("img",{src:"https://x0.ifengimg.com/ucms/2021_50/84364D5CBFFF49F0CA5599277E70616B715E99A8_size2_w48_h48.png",alt:"paste"}),e?"\u786e\u8ba4":"\u7c98\u8d34"]})})}}]),n}(a.PureComponent),je=be,fe=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).markParent=function(){var t=e.props,n=t.activeId,a=t.parentId;ee(n===a?"":n)},e.clearParent=function(e){e.stopPropagation(),ee("")},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.activeId,n=e.parentId;return Object(w.jsx)(x.a,{title:Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{children:"\u6307\u5b9a\u4e3a\u7236\u5bb9\u5668"}),Object(w.jsx)("br",{}),Object(w.jsxs)("span",{style:{fontWeight:"lighter"},children:["\u65b0\u7684\u7ec4\u4ef6\u5c06\u5f3a\u5236\u521b\u5efa\u5728\u8be5\u7ec4\u4ef6\u5185\uff0c\u8868\u73b0\u5728\u6811\u72b6\u56fe\u4e2d\u4e3a",Object(w.jsx)("span",{style:{color:"#ffc864"},children:"\u6a59\u8272\u8fb9\u6846"})]})]}),children:Object(w.jsxs)("button",{className:"btn parent ".concat(n&&n===t?"active":""),onClick:this.markParent,children:[Object(w.jsx)(k,{icon:"parent"}),n&&Object(w.jsx)("div",{className:"clearParent",onClick:this.clearParent,children:Object(w.jsx)(k,{icon:"x"})})]})})}}]),n}(a.PureComponent);var me=Object(s.b)((function(e){return{activeId:e.activeId,parentId:e.parentId,dataMap:e.dataMap}}))(fe),xe=n(524),ve=xe.a.Option,Oe=[.1,.25,.5,1,1.5,2,4],ye=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).selectRef=i.a.createRef(),e.resizeTo=function(e){B(null,e.value)},e.selectBlur=function(){e.selectRef.current.blur()},e.clickToScale=function(t){var n=t.currentTarget.dataset.scaletype,a=e.props.scale;if("-"===n){var i=Oe.findIndex((function(e){return e>=a}));i>0&&B(null,Oe[i-1])}else{var c=Oe.findIndex((function(e){return e>a}));c<Oe.length&&B(null,Oe[c])}},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props.scale;return Object(w.jsxs)("div",{className:"resize",children:[Object(w.jsx)("button",{"data-scaletype":"-",className:"btn",style:{margin:"0 2px"},onClick:this.clickToScale,children:"-"}),Object(w.jsx)(xe.a,{ref:this.selectRef,value:{value:e,label:parseInt(100*e)+"%"},labelInValue:!0,showArrow:!1,onChange:this.resizeTo,onSelect:this.selectBlur,dropdownStyle:{textAlign:"center"},style:{width:70,textAlign:"center"},children:Oe.map((function(e,t){return Object(w.jsx)(ve,{value:e,children:100*e+"%"},t)}))}),Object(w.jsx)("button",{"data-scaletype":"+",className:"btn",style:{margin:"0 2px"},onClick:this.clickToScale,children:"+"})]})}}]),n}(a.PureComponent);var we=Object(s.b)((function(e){return{scale:e.scale}}))(ye),Ce=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){return Object(w.jsx)(ue.a,{content:Object(w.jsx)("div",{style:{fontSize:"12px"},children:Object(w.jsxs)("ul",{style:{paddingBottom:0,paddingLeft:"14px",margin:0},children:[Object(w.jsx)("li",{children:"\u7a7a\u683c + \u9f20\u6807\u62d6\u62fd\u79fb\u52a8\u753b\u5e03"}),Object(w.jsx)("li",{children:"command + \u6eda\u8f6e\u653e\u5927\u7f29\u5c0f"}),Object(w.jsx)("li",{children:"delete \u5220\u9664\u56fe\u5f62"}),Object(w.jsx)("li",{children:"\u79fb\u52a8\u56fe\u5f62\u65f6\u6309\u4f4f command \u53ef\u5355\u72ec\u79fb\u52a8"}),Object(w.jsx)("li",{children:"\u53cc\u51fb\u6811\u8282\u70b9\u7f16\u8f91\u540d\u79f0"})]})}),children:Object(w.jsx)("button",{className:"btn help",children:Object(w.jsx)(k,{icon:"tip"})})})}}]),n}(a.PureComponent),ke=Ce,Ie=n(306),Se=n(219),Ne=n.n(Se),Te=new Ie.a({distance:8,outerStrength:3,color:11184810,quality:1}),ze=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={hitObject:null,nextRectColor:""},e.keyEvent=function(t){var n=e.props.mode;27===t.keyCode&&"rect"===n&&F();["input","textarea","select","button"].includes(t.target.tagName.toLowerCase())||82!==t.keyCode||t.metaKey||e.drawNormal()},e.drawNormal=function(){var t=e.props,n=t.dataMap,a=t.colorType,i=t.colorLightness,c=window.app,r=c.stage.children.filter((function(e){return"bc"!==e.name&&"point"!==e.name}));q("rect"),r.forEach((function(e){return e.interactive=!1})),c.stage.removeAllListeners(),c.stage.on("pointermove",e.findHit);var s,l={},d=new u.b;c.stage.cursor="crosshair";var p=Ne()({luminosity:i,hue:a});s=K(p),"hue"!==a&&e.setState({nextRectColor:p});var h=function(t){var a=e.props,i=a.parentId,r=a.scale,h=a.extraSetting,g=e.state.hitObject,b=Object(o.a)({},t.data.global),j=new u.b;if(c.stage.removeChild(d),Math.abs(b.x-l.x)<2&&Math.abs(b.y-l.y)<2)return c.stage.off("pointerup"),void c.stage.off("pointerupoutside");var f=Math.abs(b.x-l.x)/r,m=Math.abs(b.y-l.y)/r;if(j.lineStyle(4,s,1),j.beginFill(s,.2),j.drawRect(0,0,f,m),j.x=(Math.min(l.x,b.x)-c.stage.x)/r,j.y=(Math.min(l.y,b.y)-c.stage.y)/r,j.endFill(),i||g){var x,v=Object(o.a)({},n),y=(x=L(i||g.name,v)).id+"_"+x.willCreateKey;x.children.push({id:y,name:"\u7ec4\u4ef6".concat(y),x:j.x,y:j.y,width:f,height:m,children:[],color:p,willCreateKey:1}),x.willCreateKey++,j.name=y,j.text="\u7ec4\u4ef6".concat(y),c.stage.addChild(j),Q(y),Z(y),ce(v)}else{var w=n.willCreateKey+"";ce(Object(o.a)(Object(o.a)({},n),{},{willCreateKey:n.willCreateKey+1,children:[].concat(Object(O.a)(n.children),[{id:w,name:"\u7ec4\u4ef6".concat(w),x:j.x,y:j.y,width:f,height:m,children:[],color:p,willCreateKey:1}])})),j.name=w,j.text="\u7ec4\u4ef6".concat(w),c.stage.addChild(j),Q(w),Z(w)}l={};var C={fontFamily:"Arial",fontSize:"13px",fontWeight:"bold",fill:p,stroke:A()(p).isLight()?"rgba(0, 0, 0, 0.7)":"rgba(255, 255, 255, 0.7)",strokeThickness:4,dropShadow:!0,dropShadowColor:"#cccccc",dropShadowAngle:Math.PI/6,dropShadowDistance:2,dropShadowBlur:4,wordWrap:!0,wordWrapWidth:440},k=new u.e(j.text,C);k.name="text",k.x=0,k.y=-24,k.resolution=2,k.visible=h.isShowText,j.addChild(k),e.drawNormal(),c.stage.off("pointerup"),c.stage.off("pointerupoutside")};c.stage.on("pointerdown",(function(t){var n=e.props,r=n.parentId,u=n.dataMap,g=e.state.hitObject;if("hue"===a&&(r||g)){var b=L(r||g.name,u);p=Ne()({hue:b?b.color:"",luminosity:i})}s=K(p),e.setState({nextRectColor:p}),0===t.data.button&&(l=Object(o.a)({},t.data.global),c.stage.off("pointermove",e.findHit),d.visible=!1,d.name="tmp",c.stage.addChild(d),c.stage.on("pointermove",(function(e){d.visible=!0;var t=Object(o.a)({},e.data.global);d.clear(),d.lineStyle(4,s,1),d.beginFill(s,.2),d.drawRect((l.x-c.stage.x)/c.stage.scale.x,(l.y-c.stage.y)/c.stage.scale.y,(t.x-l.x)/c.stage.scale.x,(t.y-l.y)/c.stage.scale.y),d.endFill()})),c.stage.on("pointerup",h),c.stage.on("pointerupoutside",h))}))},e.findHit=function(t){var n=e.state.hitObject,a=E(t.data.global);(!n||!a||n&&a&&a.name!==n.name)&&(n&&(n.filters=[],n.isHit=!1),a&&(a.filters=[Te],a.isHit=!0),e.setState({hitObject:a}))},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.keyEvent,!1)}},{key:"componentWillUnmount",value:function(){var e=window.app;document.removeEventListener("keydown",this.keyEvent,!1),e.stage.removeAllListeners()}},{key:"render",value:function(){var e=this.props.mode,t=this.state.nextRectColor;return Object(w.jsx)(x.a,{title:"\u521b\u5efa\u77e9\u5f62 (R)",children:Object(w.jsx)("button",{onClick:this.drawNormal,className:"btn ".concat("rect"===e?"active":""),style:"rect"===e?{color:t}:{},children:Object(w.jsx)(k,{icon:"rect"})})})}}]),n}(a.PureComponent);var Me,De,Ae=Object(s.b)((function(e){return{mode:e.mode,scale:e.scale,parentId:e.parentId,dataMap:e.dataMap,extraSetting:e.extraSetting}}))(ze),Ee=le.a.div(Me||(Me=Object(oe.a)(["\n  \n  .groupTitle {\n    font-size: 12px;\n    color: #767676;\n  }\n\n  .chooses {\n    padding: 4px 0 0 12px;\n    font-size: 12px;\n    margin-bottom: 6px;\n\n    .chooseItem {\n      display: inline-flex;\n      align-items: center;\n      justify-content: center;\n      padding: 0 6px;\n      margin: 0 2px;\n      height: 28px;\n      cursor: pointer;\n      border: solid 1px transparent;\n      transition: all .3s;\n      \n      &:hover {\n        border: solid 1px #e9e9e9;\n        border-radius: 4px;\n      }\n\n      &.active {\n        border-radius: 4px;\n        box-shadow: 1px 1px 9px 1px #d0d0d099;\n        border: solid 1px #e9e9e9;\n      }\n    }\n  }\n"]))),_e=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={randomColorType:""},e.getColorTypeText=function(e){return"hue"===e?Object(w.jsxs)("div",{style:{margin:"0 2px"},children:[Object(w.jsx)("span",{style:{color:"#a31131"},children:"\u7cfb"}),Object(w.jsx)("span",{style:{color:"#d81316"},children:"\u5217"}),Object(w.jsx)("span",{style:{color:"#ef758b"},children:"\u989c"}),Object(w.jsx)("span",{style:{color:"#f9bdcb"},children:"\u8272"})]}):Object(w.jsx)("div",{style:{margin:"0 2px",backgroundImage:"url('https://x0.ifengimg.com/ucms/2022_07/16E4BA1EA98E030BBCB4ACC21679A66C83E60C7C_size583_w800_h450.gif')",WebkitBackgroundClip:"text",color:"transparent"},children:"\u5b8c\u5168\u968f\u673a"})},e.getColorLightnessText=function(e){switch(e){case"light":return Object(w.jsx)("div",{style:{color:"silver",textShadow:"1px 1px 5px #cbcbcb",margin:"0 2px"},children:"\u4eae\u8272"});case"dark":return Object(w.jsx)("div",{style:{fontWeight:"bold",margin:"0 2px"},children:"\u6697\u8272"});default:return null}},e.handleChange=function(t){var n=e.props.onChange,a=t.currentTarget.dataset;n(a.type,a.value)},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.colorType,n=e.colorLightness;return Object(w.jsx)(ue.a,{trigger:"click",placement:"bottomRight",content:Object(w.jsxs)(Ee,{children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"groupTitle",children:"\u968f\u673a\u989c\u8272\u8303\u56f4\uff1a"}),Object(w.jsxs)("div",{className:"chooses",children:[Object(w.jsx)("div",{"data-type":"colorType","data-value":"hue",className:"chooseItem ".concat("hue"===t?"active":""),onClick:this.handleChange,children:this.getColorTypeText("hue")}),Object(w.jsx)("div",{"data-type":"colorType","data-value":"",className:"chooseItem ".concat(""===t?"active":""),onClick:this.handleChange,children:this.getColorTypeText("")})]})]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("div",{className:"groupTitle",children:"\u8272\u5ea6\uff1a"}),Object(w.jsxs)("div",{className:"chooses",children:[Object(w.jsx)("div",{"data-type":"colorLightness","data-value":"",className:"chooseItem ".concat(""===n?"active":""),onClick:this.handleChange,children:Object(w.jsx)("div",{children:"\u968f\u673a"})}),Object(w.jsx)("div",{"data-type":"colorLightness","data-value":"light",className:"chooseItem ".concat("light"===n?"active":""),onClick:this.handleChange,children:this.getColorLightnessText("light")}),Object(w.jsx)("div",{"data-type":"colorLightness","data-value":"dark",className:"chooseItem ".concat("dark"===n?"active":""),onClick:this.handleChange,children:this.getColorLightnessText("dark")})]})]})]}),children:Object(w.jsxs)("div",{className:"colorType",children:[this.getColorTypeText(t),this.getColorLightnessText(n)]})})}}]),n}(a.PureComponent),Pe=_e,Le=n(529),Fe=n(533),Be=n(536),Ke=n(535),Re={mobile:[{name:"Offline",desc:"\u79bb\u7ebf\u9875\u9762",img:"https://x0.ifengimg.com/ucms/2021_52/BC1A481C15707E79BF4D474BA10F66049198AEF8_size21_w361_h653.png",moreUrl:"https://sys-manager.shank.ifeng.com/doc/web-ui/?path=/story/component-mobile-offline--offline"},{name:"comment",desc:"\u8bc4\u8bba",img:"https://x0.ifengimg.com/ucms/2021_51/A87578C27CF47CADCB110980ADE7670CFF2B19C9_size33_w359_h667.png",moreUrl:"https://sys-manager.shank.ifeng.com/doc/web-ui/?path=/story/component-mobile-comment--comment",icon:"comment"},{name:"Share Comment",desc:"\u5206\u4eab\u9875\u8bc4\u8bba",img:"https://x0.ifengimg.com/ucms/2021_51/6DFC77739A136E0C5DAFB8677CD5CA00EF9D3401_size61_w374_h667.png",moreUrl:"https://sys-manager.shank.ifeng.com/doc/web-ui/?path=/story/component-mobile-comment--share-comment",icon:"comment"},{name:"PageBottomBrand",desc:"\u6d6e\u52a8\u5e95",img:"https://x0.ifengimg.com/ucms/2021_52/B9B318D3C3123B1E4463B006A545D78DBA1EF7BB_size16_w359_h665.png",moreUrl:"https://sys-manager.shank.ifeng.com/doc/web-ui/?path=/story/component-mobile-pagebottombrand--atlas",icon:"yinliu"},{name:"SimpleGuideLayer",desc:"\u4e2d\u90e8\u5f15\u6d41\u5f39\u7a97",img:"https://x0.ifengimg.com/ucms/2021_52/45B18C4E8DAE422C22AF9D1C170ED5D06FA05DA7_size56_w374_h666.png",moreUrl:"https://sys-manager.shank.ifeng.com/doc/web-ui/?path=/story/component-mobile-simpleguidelayer--simple-guide-layer",icon:"yinliu"}],pc:[{name:"video",desc:"\u89c6\u9891\u64ad\u653e\u5668",img:"https://x0.ifengimg.com/ucms/2021_51/C64A57A0FD1D79DCEC5B7883451A3BB787589FF7_size30_w930_h527.png",moreUrl:"https://sys-manager.shank.ifeng.com/doc/web-ui/?path=/story/component-pc-video--player",icon:"video",dependencies:["@ifeng/three_terminal"]},{name:"comment",desc:"\u8bc4\u8bba",img:"https://x0.ifengimg.com/ucms/2021_52/418861D2DC0518C43ED3EB8CE7A2921BE6D6F5F4_size39_w764_h409.png",moreUrl:"https://sys-manager.shank.ifeng.com/doc/web-ui/?path=/story/component-pc-comment--comment",icon:"comment",dependencies:["@ifeng/three_terminal"]}]},We=le.a.div(De||(De=Object(oe.a)(["\n  \n  .highlight {\n    margin: 0 6px 0 4px;\n    font-style: italic;\n    text-shadow: 1px 1px 3px rgba(189, 189, 189, 0.48);\n    \n    &.update {\n      color: #ffc65c;\n    }\n    \n    &.create {\n      color: #3FD136;\n    }\n  }\n  \n  .tipList {\n    margin-top: 20px;\n    \n    & li {\n      font-size: 12px;\n      margin: 2px 0;\n    }\n  }\n  \n  .extraWp {\n    padding-left: 24px;\n    margin-top: 30px;\n    \n    .extraTitle {\n      border-left: solid 4px #3490ff;\n      margin-bottom: 10px;\n      padding-left: 8px;\n    }\n    \n    .extra {\n      display: flex;\n      align-items: center;\n      font-size: 12px;\n      padding-left: 12px;\n      \n      .ant-checkbox-wrapper {\n        margin-right: 8px;\n      }\n    }\n  }\n"]))),Ue=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={dependencies:[]},e.handleChange=function(t,n){(0,e.props.onChangeSetting)(t,n)},e.handleDependenciesCheckbox=function(t){var n=t.target.checked,a=e.props.onChangeSetting,i=e.state.dependencies;a("isCreateDependenciesText",!!n&&i)},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.onChangeSetting,t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X.getState().dataMap,t=[];return function e(n){if(n.config&&n.config.component&&n.config.component.preComponent&&t.push.apply(t,Object(O.a)(n.config.component.preComponent)),n.children&&n.children.length>0)for(var a in n.children)e(n.children[a])}(e),t}(),n=[],a=Re.pc,i=Re.mobile;Array.from(new Set(t)).forEach((function(e){var t=null;"pc"===e.type&&(t=a.find((function(t){return t.name===e.name}))),"mobile"===e.type&&(t=i.find((function(t){return t.name===e.name}))),t&&n.push.apply(n,Object(O.a)(t.dependencies))}));var c=Array.from(new Set(n));c.length<1?e("isCreateDependenciesText",!1):e("isCreateDependenciesText",c),this.setState({dependencies:c})}},{key:"render",value:function(){var e=this,t=this.state.dependencies,n=this.props,a=n.env,i=n.setting,c="custom"===a;return Object(w.jsxs)(We,{children:[Object(w.jsxs)("div",{children:["\u8fd9\u662f\u6765\u81ea ",Object(w.jsx)("strong",{children:"custom"})," \u7684\u4e00\u4e2a",Object(w.jsx)("span",{className:"highlight ".concat(c?"update":"create"),children:c?"\u66f4\u65b0":"\u65b0\u5efa"}),"\u64cd\u4f5c\uff0c\u5c06\u4f1a\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a"]}),Object(w.jsxs)("ol",{className:"tipList",children:[Object(w.jsxs)("li",{children:["\u8282\u70b9\u7684\u4fe1\u606f",c?"\u66f4\u65b0":"\u4fdd\u5b58","\u5230",Object(w.jsx)("span",{className:"code",children:"config_split.js"}),"\u4e2d\uff1b"]}),Object(w.jsxs)("li",{children:["\u788e\u7247\u5185\u5bb9\u5199\u5165",Object(w.jsx)("span",{className:"code",children:"config.js"}),"\u7684 allData\uff1b"]}),Object(w.jsxs)("li",{children:["\u4f1a\u751f\u6210\u4e00\u4efd\u4ee3\u7801\uff0c\u4e3a\u4e86\u4e0d\u5f71\u54cd\u539f\u6587\u4ef6\uff0c\u6240\u4ee5\u4ee3\u7801\u88ab\u653e\u7f6e\u5728\u6e90\u6587\u4ef6\u6839\u76ee\u5f55\u7684",Object(w.jsx)("span",{className:"code",children:"__tmp_split__"}),"\u6587\u4ef6\u5939\u91cc\uff0c\u6309\u9700\u67e5\u7528\u3002"]})]}),Object(w.jsxs)("div",{className:"extraWp",children:[Object(w.jsx)("div",{className:"extraTitle",children:"\u989d\u5916\u7684\u53ef\u9009\u64cd\u4f5c\uff1a"}),t.length>0&&Object(w.jsxs)("div",{className:"extra",children:[Object(w.jsx)(Be.a,{checked:i.isCreateDependenciesText,onChange:this.handleDependenciesCheckbox}),"\u8282\u70b9\u4e2d\u542b\u6709\u9884\u8bbe\u7ec4\u4ef6\uff0c\u751f\u6210\u5e26\u6709",Object(w.jsx)(ue.a,{content:Object(w.jsx)("ul",{style:{padding:"0 0 0 12px",margin:0},children:t.map((function(e,t){return Object(w.jsx)("li",{style:{fontSize:"12px"},children:e},t)}))}),children:Object(w.jsx)(v.a,{type:"link",style:{fontSize:"12px",padding:0,height:"22px"},children:"\u8fd9\u4e9b\u4f9d\u8d56"})}),"\u7684 .txt \u6587\u4ef6\uff0c\u65b9\u4fbf\u5b89\u88c5"]}),Object(w.jsxs)("div",{className:"extra",style:{color:"#a7a7a7"},children:[Object(w.jsx)(Be.a,{checked:i.isCreateLayout,disabled:!0,onChange:function(t){return e.handleChange("isCreateLayout",t.target.checked)}}),"\u521b\u5efa\u901a\u680f\u788e\u7247\uff0c\u5e76\u5e94\u7528\u5230\u9879\u76ee\u4e2d"]}),Object(w.jsx)("div",{className:"extra",style:{marginTop:"8px",color:"#a7a7a7"},children:"React\u7ec4\u4ef6\u5199\u6cd5\uff1a"}),Object(w.jsx)("div",{className:"extra",style:{paddingLeft:"32px",marginTop:"4px",color:"#a7a7a7"},children:Object(w.jsxs)(Ke.a.Group,{disabled:!0,value:i.reactType,onChange:function(t){return e.handleChange("reactType",t.target.value)},children:[Object(w.jsx)(Ke.a,{value:"function",children:Object(w.jsx)("span",{style:{fontSize:"12px"},children:"\u51fd\u6570\u5f0f\u5199\u6cd5"})}),Object(w.jsx)(Ke.a,{value:"class",children:Object(w.jsx)("span",{style:{fontSize:"12px"},children:"class \u5199\u6cd5"})})]})})]})]})}}]),n}(a.PureComponent);var Ve,He,Ge=Object(s.b)((function(e){return{env:e.env}}))(Ue),Je=le.a.div(Ve||(Ve=Object(oe.a)(["\n  .finish {\n    margin-left: 4px;\n    display: inline-flex;\n    align-items: center;\n\n    :hover {\n      .rotate {\n        animation: rotate360 .7s infinite linear, rotate360 .7s ease-in;\n      }\n    }\n\n    .icon {\n      position: relative;\n      margin-right: 6px;\n\n      .rotate {\n        transform-origin: center;\n        \n        &.leave {\n          animation: rotate360B 1s ease-out;\n        }\n      }\n      \n      .ok {\n        position: absolute;\n        left: 0;\n        right: 0;\n        top: 0;\n        bottom: 0;\n        margin: auto;\n        font-size: 16px;\n        line-height: 16px;\n      }\n    }\n  }\n\n  @keyframes rotate360 {\n    from {\n      transform: rotate(0);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n\n  @keyframes rotate360B {\n    from {\n      transform: rotate(0);\n    }\n\n    to {\n      transform: rotate(360deg);\n    }\n  }\n"]))),Xe=le.a.div(He||(He=Object(oe.a)(["\n  will-change: transfrom;\n  \n  .ant-tabs-tab {\n    justify-content: flex-end;\n    will-change: transfrom;\n\n    .tabTitle {\n      text-align: right;\n\n      .subTitle {\n        font-size: 12px;\n        color: #9d9d9d!important;\n        text-shadow: none!important;\n      }\n    }\n  }\n"]))),$e=Le.a.TabPane,qe=["\u4fdd\u5b58","\u521b\u5efa","\u4e0b\u8f7d"],Ye=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={isShowModal:!1,isShowBC:!1,isLeave:!1,tabIndex:"0",finishLoading:!1,extraSetting:{isCreateDependenciesText:!0,isCreateLayout:!1,reactType:"function"}},e.eye=i.a.createRef(),e.toggleIsShowModal=function(){return e.setState({isShowModal:!e.state.isShowModal})},e.toggleIsShowBC=function(){return e.setState({isShowBC:!e.state.isShowBC})},e.trueLeave=function(){return e.setState({isLeave:!0})},e.falseLeave=function(){return e.setState({isLeave:!1})},e.changeTabIndex=function(t){return e.setState({tabIndex:t})},e.changeExtraSetting=function(t,n){var a=e.state.extraSetting;e.setState({extraSetting:Object(o.a)(Object(o.a)({},a),{},Object(m.a)({},t,n))})},e.finish=function(){var t=e.props.dataMap,n=e.state.extraSetting;e.setState({finishLoading:!0}),window.opener.postMessage({type:"finish",data:{dataMap:t,chipData:V(),extraSetting:n}},"*"),window.addEventListener("message",e.watchSuccess,!1)},e.watchSuccess=function(t){var n=t.data.type,a=e.state.tabIndex;"update_success"===n&&(e.setState({finishLoading:!1,isShowModal:!1}),j.b.success("".concat(qe[a],"\u6210\u529f")),window.removeEventListener("message",e.watchSuccess,!1))},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props.env,t=this.state,n=t.isShowModal,a=t.isShowBC,i=t.isLeave,c=t.tabIndex,r=t.extraSetting,s=t.finishLoading;return Object(w.jsxs)(Je,{children:[Object(w.jsxs)(v.a,{className:"finish",shape:"round",type:"primary",onClick:this.toggleIsShowModal,onMouseEnter:this.falseLeave,onMouseLeave:this.trueLeave,children:[Object(w.jsxs)("div",{className:"icon",children:[Object(w.jsx)(k,{icon:"finish",style:{fontSize:"20px"},className:"rotate ".concat(i?"leave":"")}),Object(w.jsx)(k,{icon:"ok",className:"ok"})]}),"\u751f\u6210\u4e3a..."]}),Object(w.jsx)(Fe.a,{title:Object(w.jsxs)("div",{style:{position:"relative"},children:[Object(w.jsx)("span",{children:"\u751f\u6210\u4e3a..."}),Object(w.jsx)(v.a,{type:"link",ref:this.eye,style:{position:"absolute",top:0,right:"40px",padding:0,height:"22px",display:"flex"},onMouseEnter:this.toggleIsShowBC,onMouseLeave:this.toggleIsShowBC,children:Object(w.jsx)(k,{icon:"eye",style:{height:"22px",marginRight:"4px"}})})]}),className:a?"opacity":"",visible:n,destroyOnClose:!0,width:1e3,okText:qe[c],cancelText:"\u53d6\u6d88",confirmLoading:s,onOk:this.finish,onCancel:this.toggleIsShowModal,children:Object(w.jsx)(Xe,{children:Object(w.jsxs)(Le.a,{tabPosition:"left",activeKey:c,size:"small",onChange:this.changeTabIndex,children:[Object(w.jsx)($e,{tab:Object(w.jsxs)("div",{className:"tabTitle",children:[Object(w.jsx)("span",{children:"\u4fdd\u5b58\u5230\u539f\u9879\u76ee"}),Object(w.jsx)("div",{className:"subTitle",children:"\u4fdd\u5b58\u3002\u3002\u3002"})]}),children:Object(w.jsx)(Ge,{setting:r,onChangeSetting:this.changeExtraSetting})},0),Object(w.jsx)($e,{tab:Object(w.jsxs)("div",{className:"tabTitle",children:[Object(w.jsx)("span",{children:"\u4e2a\u6027\u5316React"}),Object(w.jsx)("div",{className:"subTitle",children:"\u521b\u5efa\u4e00\u4e2a\u9879\u76ee"})]}),disabled:0===e.indexOf("custom"),children:"1"},1),Object(w.jsx)($e,{tab:Object(w.jsxs)("div",{className:"tabTitle",children:[Object(w.jsx)("span",{children:"\u4ec5\u4e0b\u8f7d"}),Object(w.jsx)("div",{className:"subTitle",children:"\u4e0b\u8f7d\u4e3azip"})]}),children:"2"},2)]})})})]})}}]),n}(a.PureComponent);var Qe,Ze=Object(s.b)((function(e){return{env:e.env,dataMap:e.dataMap}}))(Ye),et=le.a.span(Qe||(Qe=Object(oe.a)(["\n  cursor: pointer;\n  transition: color .3s;\n  \n  img {\n    width: 12px;\n    height: 12px;\n  }\n\n  &:hover {\n    color: #479bff;\n  }\n"]))),tt=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={isEditing:!1},e.inputRef=i.a.createRef(),e.startEdit=function(){e.props.readOnly||(e.setState({isEditing:!0}),setTimeout((function(){document.addEventListener("click",e.cancelEdit)})))},e.cancelEdit=function(t){var n=e.props.onChange;e.inputRef.current&&!e.inputRef.current.input.contains(t.target)&&(n&&n(e.inputRef.current.input.value),e.setState({isEditing:!1}),document.removeEventListener("click",e.cancelEdit))},e.handleEnter=function(){(0,e.props.onChange)(e.inputRef.current.input.value),e.setState({isEditing:!1}),document.removeEventListener("click",e.cancelEdit)},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.style,a=e.size,i=e.inputStyle,c=e.readOnly;return this.state.isEditing?Object(w.jsx)(ge.a,{ref:this.inputRef,size:a,autoFocus:!0,defaultValue:t,onPressEnter:this.handleEnter,style:i}):Object(w.jsxs)(et,{style:n,onClick:this.startEdit,children:[t,!c&&Object(w.jsx)("img",{src:"https://x0.ifengimg.com/ucms/2021_51/CBFEA224AAA021F13FB679CC0AA31703DAF88B56_size1_w48_h48.png",alt:""})]})}}]),n}(a.PureComponent);tt.defaultProps={readOnly:!1};var nt,at=tt,it=le.a.div(nt||(nt=Object(oe.a)(["\n  position: relative;\n  height: 48px;\n  background-color: #ffffff;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  z-index: 4;\n  box-shadow: 0 0 4px 2px #e1e1e1;\n  padding: 0 8px;\n\n  .centerPart {\n    position: absolute;\n    width: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    z-index: -1;\n\n    .fileNameWp {\n      display: flex;\n      align-items: center;\n      cursor: pointer;\n\n      .env {\n        font-size: 12px;\n        margin-right: 10px;\n        font-style: italic;\n        text-shadow: 1px 1px 3px rgba(189, 189, 189, 0.48);\n      }\n\n      .en, .cn {\n        cursor: pointer;\n\n        &:hover {\n          color: #76abe2;\n        }\n      }\n\n      .en {\n        font-size: 16px;\n        font-weight: bold;\n      }\n\n      .cn {\n        font-size: 12px;\n      }\n\n      i {\n        margin-left: 2px;\n        cursor: pointer;\n\n        :hover {\n          color: #2b96ff;\n        }\n      }\n\n      input {\n        font-weight: normal;\n      }\n\n    }\n  }\n\n  .btn {\n    position: relative;\n    display: inline-flex;\n    justify-content: center;\n    align-items: center;\n    margin-right: 6px;\n    background-color: white;\n    outline: none;\n    border: solid 1px transparent;\n    font-size: 16px;\n    width: 32px;\n    height: 32px;\n    padding: 4px;\n    border-radius: 5px;\n    cursor: pointer;\n    transition: all .3s;\n\n    &.image {\n      &:after {\n        content: '';\n        position: absolute;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background-image: radial-gradient(40px 30px ellipse at 18px 18px, #40b4ca, transparent 30%);\n        opacity: 0;\n        transition: all ease-out 2s;\n      }\n\n      &:hover {\n        &::after {\n          opacity: 1;\n        }\n      }\n    }\n\n    &.parent {\n      &:after {\n        content: '';\n        position: absolute;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background-image: radial-gradient(40px 20px ellipse at 14px 9px, #ffc864, transparent 30%);\n        opacity: 0;\n        transition: all ease-out 2s;\n      }\n\n      &:hover {\n        &::after {\n          opacity: 1;\n        }\n      }\n    }\n\n    &.help {\n      &:after {\n        content: '';\n        position: absolute;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        background-image: radial-gradient(yellow, transparent 40%);\n        opacity: 0;\n        transition: all ease-out 2s;\n      }\n\n      &:hover {\n        &::after {\n          opacity: 1;\n        }\n      }\n    }\n\n    &:hover {\n      background-color: rgba(181, 227, 253, .3);\n    }\n\n    &:active {\n      border-color: #76abe2;\n    }\n\n    &.active {\n      border-color: #76abe2;\n      background-color: rgba(219, 245, 255, .52);\n      box-shadow: 1px 1px 3px 0 rgba(111, 172, 224, 0.38);\n    }\n\n    .clearParent {\n      position: absolute;\n      width: 16px;\n      height: 16px;\n      border-radius: 50%;\n      right: -6px;\n      top: -6px;\n      font-size: 12px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      background-color: #e5e5e5;\n      color: #666A6D;\n      transition: all .3s;\n\n      & i {\n        font-size: 14px;\n        font-weight: bold;\n      }\n\n      &:hover {\n        background-color: red;\n        color: white;\n      }\n    }\n  }\n\n  .resize {\n    display: inline-flex;\n    align-items: center;\n  }\n\n  .colorType {\n    display: inline-flex;\n    align-items: center;\n    font-size: 12px;\n    cursor: pointer;\n    padding: 0 2px;\n    box-sizing: content-box;\n    //width: 50px;\n    height: 24px;\n    line-height: 24px;\n    text-align: center;\n    user-select: none;\n  }\n\n  .paste {\n    margin-left: 4px;\n\n    &.active {\n      background-color: green;\n      border-color: green;\n    }\n\n    img {\n      width: 24px;\n      height: 24px;\n      margin-right: 4px;\n    }\n\n    &:hover {\n      img {\n        animation: shake linear .7s;\n      }\n    }\n  }\n\n  @keyframes shake {\n    from {\n      transform: translate3d(0, 0, 0);\n    }\n\n    15% {\n      transform: translate3d(-25%, 0, 0) rotate3d(0, 0, 1, -5deg);\n    }\n\n    30% {\n      transform: translate3d(20%, 0, 0) rotate3d(0, 0, 1, 3deg);\n    }\n\n    45% {\n      transform: translate3d(-15%, 0, 0) rotate3d(0, 0, 1, -3deg);\n    }\n\n    60% {\n      transform: translate3d(10%, 0, 0) rotate3d(0, 0, 1, 2deg);\n    }\n\n    75% {\n      transform: translate3d(-5%, 0, 0) rotate3d(0, 0, 1, -1deg);\n    }\n\n    to {\n      transform: translate3d(0, 0, 0);\n    }\n  }\n\n"]))),ct=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={colorType:"hue",colorLightness:""},e.print=function(){var t=e.props.dataMap;R(JSON.stringify(t)),console.log("dataMap\uff1a",t),j.b.success("\u5df2\u590d\u5236\u5230\u63a7\u5236\u53f0\u548c\u526a\u5207\u677f")},e.finishReName=function(t,n){var a=e.props.dataMap,i=Object(o.a)({},a);"en"===t&&(i.name=n),"cn"===t&&(i.cname=n),ce(i)},e.handleColorChange=function(t,n){e.setState(Object(m.a)({},t,n))},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.env,a=t.mode,i=t.dataMap,c=this.state,r=c.colorType,s=c.colorLightness,o=i.name,l=i.cname;return Object(w.jsxs)(it,{children:[Object(w.jsxs)("div",{className:"flex",children:[Object(w.jsx)(x.a,{title:"\u9009\u62e9 (Esc)",children:Object(w.jsx)("button",{onClick:F,className:"btn ".concat("choose"===a?"active":""),children:Object(w.jsx)(k,{icon:"choose"})})}),Object(w.jsx)(Ae,{colorType:r,colorLightness:s}),Object(w.jsx)(Pe,{colorType:r,colorLightness:s,onChange:this.handleColorChange})]}),Object(w.jsx)("div",{className:"centerPart",children:Object(w.jsxs)("div",{className:"fileNameWp",children:[Object(w.jsx)(at,{style:{fontSize:"16px",fontWeight:"bold"},inputStyle:{width:"160px",fontWeight:"bold"},onChange:function(t){return e.finishReName("en",t)},children:o}),Object(w.jsx)("span",{children:"-"}),Object(w.jsx)(at,{readOnly:0===n.indexOf("custom"),style:{fontSize:"12px"},inputStyle:{width:"160px",fontSize:"12px"},onChange:function(t){return e.finishReName("cn",t)},children:l})]})}),Object(w.jsxs)("div",{className:"flex",children:[Object(w.jsx)(he,{}),Object(w.jsx)(me,{}),Object(w.jsx)(ke,{}),Object(w.jsx)(we,{}),Object(w.jsx)(v.a,{type:"primary",onClick:this.print,style:{marginLeft:"20px"},children:"\u6570\u636e"}),Object(w.jsx)(je,{}),Object(w.jsx)(Ze,{})]})]})}}]),n}(a.PureComponent);var rt,st=Object(s.b)((function(e){return{env:e.env,mode:e.mode,dataMap:e.dataMap}}))(ct),ot=n(532),lt=le.a.div(rt||(rt=Object(oe.a)(["\n  flex: 1;\n  padding: 0 0 10px 0;\n  height: 100%;\n  overflow: auto;\n  position: relative;\n\n  .toolbar {\n    height: 32px;\n    background-color: #f5f5f5;\n    border: solid 1px #e5e5e5;\n    margin-bottom: 6px;\n    display: flex;\n    align-items: center;\n    padding: 0 4px;\n    position: sticky;\n    width: 100%;\n    top: 0;\n    z-index: 1;\n\n    .btn {\n      position: relative;\n      display: inline-flex;\n      justify-content: center;\n      align-items: center;\n      margin-right: 2px;\n      background-color: transparent;\n      outline: none;\n      border: solid 1px transparent;\n      font-size: 16px;\n      width: 24px;\n      height: 24px;\n      padding: 2px;\n      border-radius: 3px;\n      cursor: pointer;\n      transition: all .3s;\n\n      &:hover {\n        background-color: rgba(201, 201, 201, 0.3);\n      }\n\n      &.active {\n        background-color: rgb(215, 215, 215);\n      }\n    }\n  }\n\n  .edit .ant-tree-node-selected {\n    white-space: nowrap;\n    padding: 2px 4px;\n  }\n\n  .parent .ant-tree-node-content-wrapper {\n    outline: solid 2px #ffc864;\n    transition: all 0.3s, border 0s, line-height 0s, box-shadow 0s, outline 0s;\n  }\n\n  .treeTitle {\n    display: inline-flex;\n    align-items: center;\n\n    .iconPart {\n      margin-left: 20px;\n      display: flex;\n      align-items: center;\n\n      img {\n        width: 16px;\n        margin: 0 2px;\n      }\n      \n      .chipIcon {\n        position: relative;\n        \n        & > span {\n          position: absolute;\n          font-size: 12px;\n          top: -4px;\n          right: 1px;\n          color: white;\n          text-shadow: 0 0 1px black;\n          font-weight: bold;\n        }\n      }\n    }\n  }\n"]))),dt=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={expandedKeys:["0"],localEditId:"",isShowTreeIcon:!0,isAutoFocus:!0},e.getClassName=function(t){var n=e.props,a=n.activeId,i=n.editId,c=n.parentId,r="";return a===t&&(r+="ant-tree-node-selected"),e.state.isAutoFocus&&i===t&&(r+=" edit"),c===t&&(r+=" parent"),r},e.changeName=function(t){var n=t.target.value,a=e.props,i=a.editId,c=a.dataMap,r=Object(o.a)({},c);L(i,r).name=n;var s=window.app.stage.children.find((function(e){return e.name===i}));s&&(s.children.find((function(e){return"text"===e.name})).text=n);ce(r)},e.handleEnter=function(t){e.changeName(t),e.setState({localEditId:""}),Z("")},e.cancelEdit=function(t){"treeNodeInput"!==t.target.id&&(e.setState({localEditId:""}),Z(""),document.removeEventListener("mousedown",e.cancelEdit))},e.selectAll=function(t){t.currentTarget.select(),document.addEventListener("mousedown",e.cancelEdit)},e.treeNodeOnClick=function(t,n){e.props.editId!==n.node.key&&(Q(n.node.key),e.setState({localEditId:""}),Z(""),F())},e.treeNodeOnDoubleClick=function(t,n){var a=n.key;e.setState({localEditId:a}),Q(a),Z(a)},e.handleExpand=function(t){e.setState({expandedKeys:t})},e.updateExpandedkeys=function(){var t=e.props.activeId,n=e.state.expandedKeys,a=t.split("_"),i=[a[0]];a.reduce((function(e,t){var n=e+"_"+t;return i.push(n),n}));var c=Object(O.a)(n);i.forEach((function(e){c.includes(e)||c.push(e)})),e.setState({expandedKeys:c})},e.drop=function(e){"0"!==e.node.props.eventKey||e.node.props.dragOver?se({dropOver:e.node.props.dragOver,originKey:e.dragNodesKeys,targetKey:e.node.props.eventKey,dropPosition:e.node.props.dragOverGapTop?"top":"bottom"}):j.b.error("\u6839\u5143\u7d20\u53ea\u80fd\u4e3a\u4e00\u4e2a")},e.toggleSetting=function(t){var n=t.currentTarget.dataset.setting;"isAutoFocus"===n&&Z(""),e.setState(Object(m.a)({},n,!e.state[n]))},e.changeIsShowText=function(){var t,n=e.props,a=n.extraSetting,i=n.extraSetting.isShowText,c=window.app.stage.children.filter((function(e){return"bc"!==e.name&&"point"!==e.name})),r=[],s=Object(T.a)(c);try{for(s.s();!(t=s.n()).done;){var l=t.value;r.push(l.children.find((function(e){return"text"===e.name})))}}catch(h){s.e(h)}finally{s.f()}for(var d=0,p=r;d<p.length;d++){p[d].visible=!i}ie(Object(o.a)(Object(o.a)({},a),{},{isShowText:!i}))},e.getTreeData=function(t){var n=e.props.editId,a=e.state,i=a.isShowTreeIcon,c=a.isAutoFocus,r=a.localEditId;return t?t.map((function(t){var a="div";if(t.config&&t.config.component){var s=t.config.component.preComponent,o=s.filter((function(e){return"pc"===e.type})),l=s.filter((function(e){return"mobile"===e.type}));o.length+l.length>1?a="div":(l.length>0&&(a=Re.mobile.find((function(e){return e.name===l[0].name})).icon),o.length>0&&(a=Re.pc.find((function(e){return e.name===o[0].name})).icon))}return{key:t.id,className:e.getClassName(t.id),icon:Object(w.jsx)(k,{icon:a||"div",color:t.color}),title:Object(w.jsxs)("div",{className:"treeTitle",children:[Object(w.jsx)("span",{children:c&&n===t.id||r===t.id?Object(w.jsx)("span",{children:Object(w.jsx)(ge.a,{autoFocus:!0,id:"treeNodeInput",value:t.name,style:{width:"120px"},size:"small",onChange:e.changeName,onFocus:e.selectAll,onPressEnter:e.handleEnter})}):t.name}),Object(w.jsxs)("span",{className:"iconPart",children:[i&&t.config&&t.config.track&&t.config.track.trackId&&Object(w.jsx)("img",{style:{width:"14px"},src:"https://x0.ifengimg.com/ucms/2021_51/04BF5ED7540F3BC2AE6D3AC19C0D10974FA606B5_size2_w50_h48.png",alt:""}),i&&t.config&&t.config.chip&&t.config.chip.length>0&&Object(w.jsxs)("span",{className:"chipIcon",children:[Object(w.jsx)("img",{src:"https://x0.ifengimg.com/ucms/2021_51/CD0B86062ED829ECCAF0B9635F42E3A629DBF2AE_size2_w48_h48.png",alt:""}),Object(w.jsx)("span",{children:t.config.chip.length})]})]})]}),children:e.getTreeData(t.children)}})):[]},e}return Object(d.a)(n,[{key:"componentDidUpdate",value:function(e,t,n){e.activeId!==this.props.activeId&&this.updateExpandedkeys()}},{key:"render",value:function(){var e=this.props,t=e.dataMap,n=e.activeId,a=e.extraSetting,i=this.state,c=i.expandedKeys,r=i.isShowTreeIcon,s=i.isAutoFocus,o=i.localEditId,l=a.isShowText,d=t.name,p=t.config;return Object(w.jsxs)(lt,{children:[Object(w.jsxs)("div",{className:"toolbar",children:[Object(w.jsx)(x.a,{title:"\u663e\u793a\u5c0f\u56fe\u6807",children:Object(w.jsx)("button",{"data-setting":"isShowTreeIcon",onClick:this.toggleSetting,className:"btn ".concat(r?"active":""),children:Object(w.jsx)(k,{icon:"treeIcon",style:{fontSize:"18px"},color:"rgb(116 116 116)"})})}),Object(w.jsx)(x.a,{title:"\u521b\u5efa\u6811\u8282\u70b9\u65f6\u81ea\u52a8\u5f00\u542f\u6587\u672c\u6846\u4fee\u6539\u540d\u79f0",children:Object(w.jsx)("button",{"data-setting":"isAutoFocus",onClick:this.toggleSetting,className:"btn ".concat(s?"active":""),children:Object(w.jsx)(k,{icon:"treeAutoFocus",style:{fontSize:"18px"},color:"rgb(116 116 116)"})})}),Object(w.jsx)(x.a,{title:"\u662f\u5426\u5728\u753b\u5e03\u4e2d\u663e\u793a\u6587\u672c",children:Object(w.jsx)("button",{onClick:this.changeIsShowText,className:"btn ".concat(l?"active":""),children:Object(w.jsx)(k,{icon:"text",color:"rgb(116 116 116)"})})})]}),Object(w.jsx)(ot.a,{showIcon:r,draggable:{icon:!1},allowDrop:function(){return!0},selectedKeys:[n],expandedKeys:c,onExpand:this.handleExpand,onDoubleClick:this.treeNodeOnDoubleClick,onSelect:this.treeNodeOnClick,onDrop:this.drop,treeData:[{key:"0",icon:Object(w.jsx)(k,{icon:"all"}),className:this.getClassName("0"),title:Object(w.jsxs)("div",{className:"treeTitle",children:[Object(w.jsx)("span",{children:"0"===o?Object(w.jsx)("span",{children:Object(w.jsx)(ge.a,{autoFocus:!0,id:"treeNodeInput",value:d,style:{width:"120px"},size:"small",onChange:this.changeName,onFocus:this.selectAll,onPressEnter:this.handleEnter})}):d}),Object(w.jsxs)("span",{className:"iconPart",children:[r&&p&&p.track&&p.track.trackId&&Object(w.jsx)("img",{style:{width:"14px"},src:"https://x0.ifengimg.com/ucms/2021_51/04BF5ED7540F3BC2AE6D3AC19C0D10974FA606B5_size2_w50_h48.png",alt:""}),r&&p&&p.chip&&p.chip.length>0&&Object(w.jsxs)("span",{className:"chipIcon",children:[Object(w.jsx)("img",{src:"https://x0.ifengimg.com/ucms/2021_51/CD0B86062ED829ECCAF0B9635F42E3A629DBF2AE_size2_w48_h48.png",alt:""}),Object(w.jsx)("span",{children:p.chip.length})]})]})]}),children:t&&t.children?this.getTreeData(t.children):[]}]})]})}}]),n}(a.PureComponent);var pt,ht=Object(s.b)((function(e){return{activeId:e.activeId,editId:e.editId,parentId:e.parentId,dataMap:e.dataMap,extraSetting:e.extraSetting}}))(dt),ut=n(526),gt=n(74),bt=n.n(gt),jt=n(107),ft=n(527),mt=n(525),xt=le.a.div(pt||(pt=Object(oe.a)(["\n  position: relative;\n\n  .ant-form-item {\n    margin-bottom: 6px!important;\n  }\n\n  .params {\n    padding-left: 20px;\n  }\n\n  .customer_table {\n    width: 100%;\n    border-radius: 4px 4px 0 0;\n    border: solid 1px #e8e8e8;\n    border-spacing: 0;\n    table-layout: fixed;\n    font-size: 12px;\n    margin: 8px 0;\n\n    & tr {\n      position: relative;\n      transition: all .3s;\n\n      &:hover {\n        background-color: rgba(241, 241, 241, 0.4);\n      }\n    }\n\n    & th {\n      color: rgba(0, 0, 0, 0.85);\n      font-weight: 500;\n      text-align: left;\n      background: #f1f1f1;\n      transition: background .3s ease;\n      padding: 4px 8px;\n    }\n\n    & td {\n      position: relative;\n      transition: all .3s, border 0s;\n      padding: 3px 12px;\n\n      &.editing {\n        box-shadow: 1px 1px 6px 1px rgba(130, 130, 130, 0.14);\n        border: solid 1px #ccc;\n      }\n\n      & input {\n        outline: none;\n        border: none;\n        background-color: transparent;\n        width: 100%;\n      }\n\n      &.delete {\n        cursor: pointer;\n\n        &:hover {\n          color: red;\n        }\n      }\n    }\n  }\n\n  .tip {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    font-size: 12px;\n    font-weight: lighter;\n  }\n\n  .spinning {\n    position: absolute;\n    right: 0;\n    top: 0;\n\n    .error {\n      font-size: 12px;\n      cursor: pointer;\n    }\n\n    .success {\n      font-size: 12px;\n      cursor: pointer;\n    }\n  }\n"]))),vt=xe.a.Option,Ot=[{key:"id",value:""},{key:"type",value:"other"}],yt=[{key:"type",value:"other"}],wt=null,Ct=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,c=new Array(a),r=0;r<a;r++)c[r]=arguments[r];return(e=t.call.apply(t,[this].concat(c))).state={initConfig:{},editingId:"",paramsList:[],isUpdating:!1,updateRes:null},e.formRef=i.a.createRef(),e.update=function(){var t=e.props,n=t.activeId,a=t.dataMap,i=L(n,a),c=i.config&&i.config.track?i.config.track:{isH5:!1,parameterType:"page",parameterDescription:"",trackId:""};e.setState({initConfig:c,paramsList:c.parameter||[{key:"id",value:""},{key:"type",value:"other"}]},(function(){e.formRef.current.resetFields();var t=Object(o.a)({},a),i=L(n,t);i.config=Object(o.a)(Object(o.a)({},i.config),{},{track:Object(o.a)(Object(o.a)({},c),{},{parameter:c.parameter||Ot})}),ce(t)}))},e.handleFocus=function(t){var n=e.state.editingId,a=t.target.dataset,i=a.index,c=a.inputtype;n!==c+i+""&&e.setState({editingId:c+i+""}),document.addEventListener("click",e.hideShadow)},e.handleTabKey=function(t){var n=e.state.editingId;"Tab"===t.key&&(/^key/.test(n)?e.setState({editingId:n.replace("key","value")}):e.setState({editingId:"key"+(parseInt(/[0-9]+/.exec(n)[0])+1)}))},e.handleTypeChange=function(t){var n="page"===t?Ot:yt;e.setState({paramsList:n}),e.updateParams(n)},e.handleParamsChange=function(t){var n=t.target,a=n.dataset,i=a.index,c=a.inputtype,r=n.value;i=+i;var s=e.state.paramsList,o=Object(O.a)(s);i===o.length&&o.push({key:"",value:""}),o[i][c]=r,e.setState({paramsList:o}),e.updateParams(o)},e.deleteParams=function(t){var n=t.target.dataset.index,a=e.state.paramsList,i=Object(O.a)(a);i.splice(+n,1),e.setState({paramsList:i,editingId:""}),e.updateParams(i)},e.handleFormChange=function(){var t=Object(jt.a)(bt.a.mark((function t(n,a){var i,c,r,s,l,d;return bt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.props,c=i.activeId,r=i.dataMap,s=e.state.paramsList,l=Object(o.a)({},r),(d=L(c,l)).config=Object(o.a)(Object(o.a)({},d.config),{},{track:Object(o.a)(Object(o.a)(Object(o.a)({},d.config.track),a),{},{parameter:s})}),ce(l),t.next=8,e.updateTrack(d);case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.updateParams=function(t){var n=e.props,a=n.activeId,i=n.dataMap,c=Object(o.a)({},i),r=L(a,c);r.config=Object(o.a)(Object(o.a)({},r.config),{},{track:Object(o.a)(Object(o.a)({},r.config?r.config.track:{}),{},{parameter:t})}),ce(c),e.updateTrack(r)},e.hideShadow=function(t){document.getElementById("trackTable").contains(t.target)||(e.setState({editingId:""}),document.removeEventListener("click",e.hideShadow))},e.createTrack=Object(jt.a)(bt.a.mark((function t(){var n,a,i,c,r,s,l,d,p,h,u,g,f,m,x,v,O,y;return bt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props,a=n.activeId,i=n.dataMap,c=n.dataMap,r=c.name,s=c.cname,n.trackProjectId){t.next=15;break}if(r){t.next=5;break}return j.b.error("\u8bf7\u5148\u586b\u5199\u9879\u76ee\u540d\u79f0"),t.abrupt("return");case 5:return t.next=7,b.a.post("http://test0.platform.ifengidc.com/platform/server/trackApi/createProject",{projectName:r,projectNote:s+"- from Split"});case 7:if(0!==(l=t.sent).data.code){t.next=13;break}j.b.success("\u521b\u5efa\u57cb\u70b9\u9879\u76ee\u6210\u529f"),ne(l.data.data.id),t.next=15;break;case 13:return j.b.error("\u521b\u5efa\u9879\u76ee\u5931\u8d25"),t.abrupt("return");case 15:return d=Object(o.a)({},i),p=e.state,h=p.paramsList,u=p.initConfig,g=L(a,d),f=e.formRef.current.getFieldsValue(),t.next=21,b.a.post("http://test0.platform.ifengidc.com/platform/server/trackApi/createTrackforProject",Object(o.a)(Object(o.a)({},f),{},{parameter:h.map((function(e){return{parameterIdentification:e.key,parameterValue:e.value}})),pageName:g.name,projectId:e.props.trackProjectId}));case 21:if(0!==(m=t.sent).data.code){t.next=32;break}return x=m.data.data,v=x.id,O=x.pageId,y=x.projectName,t.next=26,b.a.post("http://test0.platform.ifengidc.com/platform/server/trackApi/goOnlineForTrack",{id:v,isOnline:!0,projectName:y,pageId:O});case 26:g.config=Object(o.a)(Object(o.a)({},g.config),{},{track:Object(o.a)(Object(o.a)({},g.config?g.config.track:{}),{},{trackId:v})}),e.setState({initConfig:Object(o.a)(Object(o.a)({},u),{},{trackId:v})}),ce(d),j.b.success("\u521b\u5efa\u57cb\u70b9\u6210\u529f"),t.next=33;break;case 32:j.b.error(m.data.data[0].message);case 33:case"end":return t.stop()}}),t)}))),e.deleteTrack=Object(jt.a)(bt.a.mark((function t(){var n,a,i,c,r,s;return bt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props,a=n.activeId,i=n.dataMap,c=e.state.initConfig,r=Object(o.a)({},i),s=L(a,r),t.next=6,b.a.post("http://test0.platform.ifengidc.com/platform/server/trackApi/deleteTrack",{id:c.trackId});case 6:0===t.sent.data.code&&(s.config=Object(o.a)(Object(o.a)({},s.config),{},{track:Object(o.a)(Object(o.a)({},s.config?s.config.track:{}),{},{trackId:""})}),e.setState({initConfig:Object(o.a)(Object(o.a)({},c),{},{trackId:""})}),ce(r),j.b.success("\u5220\u9664\u57cb\u70b9\u6210\u529f"));case 8:case"end":return t.stop()}}),t)}))),e.updateTrack=function(){var t=Object(jt.a)(bt.a.mark((function t(n){var a,i,c;return bt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.state.paramsList,i=e.formRef.current.getFieldsValue(),!n.config.track.trackId){t.next=9;break}return e.setState({isUpdating:!0}),t.next=6,b.a.post("http://test0.platform.ifengidc.com/platform/server/trackApi/changeOneTrack",Object(o.a)(Object(o.a)({},i),{},{id:n.config.track.trackId,parameter:a.map((function(e){return{parameterIdentification:e.key,parameterValue:e.value}})),pageName:n.name}));case 6:0===(c=t.sent).data.code?(e.setState({updateRes:1}),wt&&clearTimeout(wt),wt=setTimeout((function(){e.setState({updateRes:null})}),2e3)):(wt&&clearTimeout(wt),e.setState({updateRes:c.data.data[0].message})),e.setState({isUpdating:!1});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.update()}},{key:"componentDidUpdate",value:function(e,t,n){e.activeId!==this.props.activeId&&this.update()}},{key:"render",value:function(){var e=this,t=this.state,n=t.editingId,a=t.paramsList,i=t.initConfig,c=t.isUpdating,r=t.updateRes,s=this.props,l=s.trackProjectId,d=s.dataMap.name;return Object(w.jsxs)(xt,{children:[Object(w.jsxs)(ft.a,{ref:this.formRef,size:"small",initialValues:Object(o.a)({},i),onValuesChange:this.handleFormChange,children:[Object(w.jsx)(ft.a.Item,{label:"\u57cb\u70b9\u4f4d\u7f6e",name:"isH5",children:Object(w.jsxs)(Ke.a.Group,{children:[Object(w.jsx)(Ke.a,{value:!1,children:"\u5ba2\u6237\u7aef"}),Object(w.jsx)(Ke.a,{value:!0,children:"h5"})]})}),Object(w.jsx)(ft.a.Item,{label:"\u57cb\u70b9\u7c7b\u578b",name:"parameterType",children:Object(w.jsxs)(xe.a,{style:{width:"120px"},onChange:this.handleTypeChange,children:[Object(w.jsx)(vt,{value:"page",children:"page"}),Object(w.jsx)(vt,{value:"action",children:"action"})]})}),Object(w.jsx)("div",{style:{fontSize:"12px",height:"24px",lineHeight:"24px"},children:"\u57cb\u70b9\u53c2\u6570\uff1a"}),Object(w.jsx)("div",{className:"params",children:Object(w.jsx)("table",{className:"customer_table",border:"1",id:"trackTable",children:Object(w.jsxs)("tbody",{children:[Object(w.jsxs)("tr",{children:[Object(w.jsx)("th",{style:{width:"32px",textAlign:"center"}}),Object(w.jsx)("th",{style:{width:"30%"},children:"key"}),Object(w.jsx)("th",{children:"value"})]}),a.concat({key:"",value:""}).map((function(t,i){return Object(w.jsxs)("tr",{children:[i===a.length?Object(w.jsx)("td",{}):Object(w.jsx)("td",{className:"delete","data-index":i,onClick:e.deleteParams,children:"-"}),Object(w.jsx)("td",{className:n==="key".concat(i)?"editing":"",children:Object(w.jsx)("input",{value:t.key,"data-index":i,"data-inputtype":"key",onFocus:e.handleFocus,onChange:e.handleParamsChange,onKeyDown:e.handleTabKey})}),Object(w.jsx)("td",{className:n==="value".concat(i)?"editing":"",children:Object(w.jsx)("input",{value:t.value,"data-index":i,"data-inputtype":"value",onFocus:e.handleFocus,onChange:e.handleParamsChange,onKeyDown:e.handleTabKey})})]},i)}))]})})}),Object(w.jsx)(ft.a.Item,{label:"\u5907\u6ce8",name:"parameterDescription",children:Object(w.jsx)(ge.a.TextArea,{placeholder:"\u53ef\u9009",style:{fontSize:"12px"}})})]}),Object(w.jsx)("div",{className:"btnBox",children:l?i.trackId?Object(w.jsx)(v.a,{type:"danger",size:"small",onClick:this.deleteTrack,children:"\u5220\u9664\u57cb\u70b9"}):Object(w.jsx)(v.a,{type:"primary",size:"small",onClick:this.createTrack,children:"\u521b\u5efa\u57cb\u70b9"}):Object(w.jsx)(ue.a,{placement:"left",content:Object(w.jsxs)("span",{style:{fontSize:"12px"},children:["\u9996\u6b21\u521b\u5efa\u57cb\u70b9\uff0c\u4f1a\u5148\u4f7f\u7528\u9879\u76ee\u540d\u79f0 ",Object(w.jsx)("strong",{children:d})," \u6765\u521b\u5efa\u57cb\u70b9\u9879\u76ee"]}),children:Object(w.jsx)(v.a,{type:"primary",size:"small",onClick:this.createTrack,children:"\u521b\u5efa\u57cb\u70b9"})})}),Object(w.jsxs)("div",{className:"spinning",children:[Object(w.jsx)(mt.a,{size:"small",spinning:c}),r&&("string"===typeof r?Object(w.jsx)(ue.a,{placement:"left",content:Object(w.jsxs)("span",{style:{fontSize:"12px"},children:[Object(w.jsx)("span",{children:"\u66f4\u65b0\u5931\u8d25\uff1a"}),Object(w.jsx)("br",{}),Object(w.jsx)("span",{children:r})]}),children:Object(w.jsx)("span",{className:"error",children:"Error"})}):Object(w.jsx)("span",{className:"success",children:"\u5df2\u66f4\u65b0"}))]})]})}}]),n}(a.PureComponent);var kt,It=Object(s.b)((function(e){return{trackProjectId:e.trackProjectId,activeId:e.activeId,dataMap:e.dataMap}}))(Ct),St=n(534),Nt=n(538),Tt=n(528),zt=le.a.div(kt||(kt=Object(oe.a)(["\n  .treeTitle {\n    display: inline-flex;\n    align-items: center;\n\n    .iconPart {\n      margin-left: 20px;\n      display: flex;\n      align-items: center;\n\n      img {\n        width: 16px;\n        margin: 0 2px;\n      }\n\n      .chipIcon {\n        position: relative;\n\n        & > span {\n          position: absolute;\n          font-size: 12px;\n          top: -4px;\n          right: 1px;\n          color: white;\n          text-shadow: 0 0 1px black;\n          font-weight: bold;\n        }\n      }\n    }\n  }\n"]))),Mt=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).getTreeData=function(t){var n=e.props.disabledId;return t?t.map((function(t){var a="div";if(t.config&&t.config.component){var i=t.config.component.preComponent,c=i.filter((function(e){return"pc"===e.type})),r=i.filter((function(e){return"mobile"===e.type}));c.length+r.length>1?a="div":(r.length>0&&(a=Re.mobile.find((function(e){return e.name===r[0].name})).icon),c.length>0&&(a=Re.pc.find((function(e){return e.name===c[0].name})).icon))}return{value:t.id,icon:Object(w.jsx)(k,{icon:a||"div",color:t.color}),className:"treeTitle",disabled:n===t.id,title:Object(w.jsxs)("div",{className:"treeTitle",children:[Object(w.jsx)("span",{children:t.name}),Object(w.jsxs)("span",{className:"iconPart",children:[t.config&&t.config.track&&t.config.track.trackId&&Object(w.jsx)("img",{style:{width:"14px"},src:"https://x0.ifengimg.com/ucms/2021_51/04BF5ED7540F3BC2AE6D3AC19C0D10974FA606B5_size2_w50_h48.png",alt:""}),t.config&&t.config.chip&&t.config.chip.length>0&&Object(w.jsxs)("span",{className:"chipIcon",children:[Object(w.jsx)("img",{src:"https://x0.ifengimg.com/ucms/2021_51/CD0B86062ED829ECCAF0B9635F42E3A629DBF2AE_size2_w48_h48.png",alt:""}),Object(w.jsx)("span",{children:t.config.chip.length})]})]})]}),children:e.getTreeData(t.children)}})):[]},e.handleChange=function(t){(0,e.props.onChange)(t)},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.value,n=e.height,a=e.dataMap,i=e.disabledId;return Object(w.jsx)(zt,{children:Object(w.jsx)(Tt.a,{multiple:!1,showSearch:!0,treeIcon:!0,style:{width:"100%"},listHeight:n,placeholder:"\u9009\u62e9\u8282\u70b9",allowClear:!0,treeDefaultExpandAll:!0,onChange:this.handleChange,value:t,treeData:[{value:"0",icon:Object(w.jsx)(k,{icon:"all"}),className:"treeTitle",title:a.name,disabled:"0"===i,children:a&&a.children?this.getTreeData(a.children):[]}]})})}}]),n}(a.PureComponent);var Dt,At=Object(s.b)((function(e){return{dataMap:e.dataMap}}))(Mt),Et=n(537),_t=le.a.div(Dt||(Dt=Object(oe.a)(["\n  .paramsList {\n    margin-top: 8px;\n    \n    .param {\n      margin-bottom: 4px;\n      font-size: 12px;\n\n      .paramName {\n        margin-right: 4px;\n        font-weight: bold;\n        color: rgba(0, 0, 0, 0.8);\n        cursor: help;\n        \n        &:hover {\n          text-decoration: underline dashed;\n        }\n      }\n    }\n  }\n"]))),Pt=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={chipData:{},dataId:""},e.initChipData=function(){var t=e.props,n=t.type,a=t.data,i=t.activeId,c=t.dataMap,r=t.onChange,s=t.chipId,l={};if(a&&Object.keys(a).length>0)l=s?Object(o.a)(Object(o.a)({},a),{},{id:s}):Object(o.a)(Object(o.a)({},a),{},{id:""});else{var d=i.split("_").length>1?i.split("_").slice(0,-1).join("_"):i,p=L(i,c),h=d===i?p:L(d,c);switch(n){case"static":l={id:"",name:"chip"+p.id,title:p.name,group:h.name};break;case"recommend":case"struct":l={id:"",name:"chip"+p.id,title:p.name,group:h.name,transform:"chip".concat(p.id,"Transform"),callback:!1}}e.setState({dataId:p.id})}e.setState({chipData:l}),r(l)},e.updateChipData=function(t,n){var a=e.state.chipData,i=e.props.onChange,c=Object(o.a)({},a);c[t]=n,e.setState({chipData:c}),i(c)},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.initChipData()}},{key:"componentDidUpdate",value:function(e,t,n){e.activeId===this.props.activeId&&e.type===this.props.type||this.initChipData()}},{key:"render",value:function(){var e=this,t=this.state,n=t.chipData,a=t.dataId,i=Object.keys(n);return Object(w.jsx)(_t,{children:Object(w.jsxs)("div",{className:"paramsList",children:[i.includes("id")&&Object(w.jsxs)("div",{className:"param",children:[Object(w.jsx)(x.a,{placement:"left",title:"\u788e\u7247\u7684\u552f\u4e00 id\u3002",children:Object(w.jsx)("span",{className:"paramName",children:"data-id:"})}),Object(w.jsx)(at,{inputStyle:{width:"120px",fontSize:"12px"},size:"small",onChange:function(t){return e.updateChipData("id",t)},children:n.id})]}),i.includes("name")&&Object(w.jsxs)("div",{className:"param",children:[Object(w.jsx)(x.a,{placement:"left",title:"\u788e\u7247\u5728\u5e93\u4e2d\u3001allData \u91cc\u7684 key \u503c\uff0c\u901a\u8fc7\u8be5\u503c\u6765\u627e\u5230\u5bf9\u5e94\u7684\u6570\u636e\u3002",children:Object(w.jsx)("span",{className:"paramName",children:"data-name:"})}),Object(w.jsx)(at,{inputStyle:{width:"120px",fontSize:"12px"},size:"small",onChange:function(t){return e.updateChipData("name",t)},children:n.name})]}),i.includes("title")&&Object(w.jsxs)("div",{className:"param",children:[Object(w.jsx)(x.a,{placement:"left",title:"\u788e\u7247\u7684\u8bf4\u660e\uff0c\u547d\u540d\u6ca1\u6709\u89c4\u8303\uff0c\u4f46\u662f\u8981\u8ba9\u7528\u6237\u77e5\u9053\u8fd9\u4e2a\u788e\u7247\u662f\u5e72\u561b\u7684\u3002",children:Object(w.jsx)("span",{className:"paramName",children:"data-title:"})}),Object(w.jsx)(at,{inputStyle:{width:"120px",fontSize:"12px"},size:"small",onChange:function(t){return e.updateChipData("title",t)},children:n.title})]}),i.includes("group")&&Object(w.jsxs)("div",{className:"param",children:[Object(w.jsx)(x.a,{placement:"left",title:Object(w.jsxs)("div",{children:["\u788e\u7247\u7684\u7ec4\u7684\u540d\u79f0\uff0c\u5982\u679c\u4e24\u4e2a\u788e\u7247\u6765\u81ea\u540c\u4e00\u90e8\u5206\uff0c\u5c31\u53ef\u4ee5\u653e\u5728\u540c\u4e00\u4e2a\u7ec4\u3002",Object(w.jsx)("br",{}),"\u548c title \u4e00\u6837\uff0c\u547d\u540d\u89c4\u5219\u7684\u8981\u6c42\u5c31\u662f\u8bed\u4e49\u5316\u3002\u5355\u4e2a\u788e\u7247\u4e5f\u5e94\u8be5\u6709\u4e2a group \u6765\u5305\u88f9\u3002"]}),children:Object(w.jsx)("span",{className:"paramName",children:"data-group:"})}),Object(w.jsx)(at,{inputStyle:{width:"120px",fontSize:"12px"},size:"small",onChange:function(t){return e.updateChipData("group",t)},children:n.group})]}),i.includes("transform")&&Object(w.jsxs)("div",{className:"param",children:[Object(w.jsx)(x.a,{placement:"left",title:"\u4e00\u4e2a\u51fd\u6570\u540d\uff0c\u8be5\u51fd\u6570\u8981\u5b9a\u4e49\u5728 script \u6807\u7b7e\u4e2d\uff0c\u7528\u4e8e\u6574\u7406\u6570\u636e\u3002",children:Object(w.jsx)("span",{className:"paramName",children:"data-transform:"})}),Object(w.jsx)(at,{inputStyle:{width:"120px",fontSize:"12px"},size:"small",onChange:function(t){return e.updateChipData("transform",t)},children:n.transform})]}),i.includes("callback")&&Object(w.jsxs)("div",{className:"param",children:[Object(w.jsx)(x.a,{placement:"left",title:"\u4e00\u4e2a\u51fd\u6570\u540d\uff0c\u8be5\u51fd\u6570\u8981\u5b9a\u4e49\u5728 script \u6807\u7b7e\u4e2d\uff0c\u7528\u4e8e\u6570\u636e\u6574\u7406\u540e\u7684\u56de\u8c03\u3002",children:Object(w.jsx)("span",{className:"paramName",children:"data-callback:"})}),Object(w.jsx)(Et.a,{size:"small",style:{marginRight:"10px"},checked:n.callback,onChange:function(t){return e.updateChipData("callback",t?"chip".concat(a,"Callback"):t)}}),n.callback&&Object(w.jsx)(at,{inputStyle:{width:"120px",fontSize:"12px"},size:"small",onChange:function(t){return e.updateChipData("callback",t)},children:n.callback})]})]})})}}]),n}(a.PureComponent);var Lt,Ft=Object(s.b)((function(e){return{activeId:e.activeId,dataMap:e.dataMap}}))(Pt),Bt=le.a.div(Lt||(Lt=Object(oe.a)(["\n  padding-left: 20px;\n  \n  .ant-popover-buttons {\n    font-size: 12px;\n  }\n"]))),Kt=xe.a.Option,Rt=[],Wt=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).changeChipValue=function(t){var n=Object(o.a)({},t),a=e.props,i=a.onChange,c=a.chip;void 0!==n.id?(i(Object(o.a)(Object(o.a)({},c),{},{chipId:n.id,chipData:n})),delete n.id):i(Object(o.a)(Object(o.a)({},c),{},{chipData:n}))},e.changeChipType=function(t){var n=e.props,a=n.onChange,i=n.chip;a(Object(o.a)(Object(o.a)({},i),{},{chipType:t}))},e.moveChip=function(t){var n=e.props,a=n.index,i=n.activeId,c=n.dataMap,r=Object(o.a)({},c),s=L(i,r),l=L(t,r),d=s.config.chip,p=l.config&&l.config.chip?l.config.chip:[];p.push(d[a]),d.splice(a,1),s.config=Object(o.a)(Object(o.a)({},s.config),{},{chip:d}),l.config=Object(o.a)(Object(o.a)({},l.config),{},{chip:p}),ce(r),j.b.success("\u79fb\u52a8\u6210\u529f")},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.chip,n=t.chipId,a=t.chipType,i=t.chipData,c=e.onDelete,r=e.onAdd,s=e.isNew,o=e.activeId;return Object(w.jsxs)(Bt,{children:[Object(w.jsxs)("div",{className:"chipType",children:[Object(w.jsx)("span",{className:"formProp",children:"\u788e\u7247\u7c7b\u578b : "}),Object(w.jsxs)(xe.a,{disabled:!s,size:"small",value:a,style:{width:"120px"},onChange:this.changeChipType,children:[Object(w.jsx)(Kt,{value:"",children:"\u65e0\u788e\u7247"}),Object(w.jsx)(Kt,{value:"static",children:"\u9759\u6001\u788e\u7247"}),Object(w.jsx)(Kt,{value:"recommend",children:"\u63a8\u8350\u4f4d\u788e\u7247"}),Object(w.jsx)(Kt,{value:"struct",children:"\u7ed3\u6784\u5316\u788e\u7247"})]})]}),Object(w.jsx)("div",{children:a&&Object(w.jsx)(Ft,{type:a,chipId:n,data:i,onChange:this.changeChipValue})}),Object(w.jsx)("div",{className:"btnBox",children:s?a&&!Rt.includes(a)&&Object(w.jsxs)(v.a,{type:"primary",ghost:!!i.id,size:"small",onClick:r,children:[i.id?"\u6dfb\u52a0":"\u521b\u5efa","\u788e\u7247"]}):Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(ue.a,{placement:"left",content:Object(w.jsxs)("div",{style:{width:"250px"},children:[Object(w.jsx)("div",{style:{fontSize:"12px",marginBottom:"4px"},children:"\u9009\u62e9\u8282\u70b9\uff1a"}),Object(w.jsx)(At,{height:300,disabledId:o,onChange:this.moveChip})]}),trigger:["click"],children:Object(w.jsx)(v.a,{type:"primary",ghost:!0,size:"small",style:{borderStyle:"dashed"},children:"\u79fb\u52a8\u81f3..."})}),Object(w.jsx)(ue.a,{placement:"left",content:Object(w.jsxs)("div",{style:{fontSize:"12px"},children:[Object(w.jsx)("span",{children:"\u53ea\u5220\u9664\u8282\u70b9\u91cc\u7684\u788e\u7247\u4fe1\u606f\uff0c"}),Object(w.jsx)("strong",{children:"\u4e0d\u4f1a\u5220\u9664 ucms \u91cc\u7684\u788e\u7247\u3002"})]}),children:Object(w.jsx)(Nt.a,{placement:"topRight",title:'\u786e\u5b9a"\u5220\u9664"\u8fd9\u4e2a\u788e\u7247\u5417',okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",okType:"danger",onConfirm:c,children:Object(w.jsx)(v.a,{danger:!0,size:"small",ghost:!0,style:{width:"100px"},children:'"\u5220\u9664"\u788e\u7247'})})})]})})]})}}]),n}(a.PureComponent);Wt.defaultProps={isNew:!1};var Ut,Vt=Object(s.b)((function(e){return{activeId:e.activeId,dataMap:e.dataMap}}))(Wt),Ht=le.a.div(Ut||(Ut=Object(oe.a)(["\n\n  .ant-collapse-header {\n    padding: 6px 16px!important;\n    user-select: none;\n    display: flex;\n    align-items: center;\n    background-color: #f5f5f5;\n    border-radius: 4px!important;\n    margin-bottom: 2px;\n    \n    &:hover {\n      background-color: #e9e9e9;\n    }\n\n    .ant-collapse-arrow {\n      font-size: 10px!important;\n    }\n\n    .collapseTitle {\n      width: 100%;\n      padding-right: 12px;\n      display: inline-flex;\n      justify-content: space-between;\n\n      strong {\n        margin: 0 2px;\n      }\n    }\n  }\n  \n  .chipType {\n    position: relative;\n    display: flex;\n    align-items: center;\n    \n    .tip {\n      position: absolute;\n      right: 0;\n      font-size: 12px;\n      color: #cccccc;\n    }\n  }\n  \n  .formProp {\n    font-size: 12px;\n    margin-right: 8px;\n  }\n  \n  .title {\n    color: rgba(0, 0, 0, 0.85);\n    font-weight: 500;\n    margin: 0 0 4px;\n    font-size: 14px;\n  }\n  \n"]))),Gt={static:"https://test0.ucms.ifeng.com/api/ns/addStaticFragment",recommend:"https://test0.ucms.ifeng.com/api/ns/addRecommendFragment"},Jt=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={isReady:!1,localChipList:[],newChip:{chipId:"",chipType:"",chipData:{}}},e.initAndUpdate=function(){var t=e.props,n=t.activeId,a=t.dataMap,i=L(n,a);e.setState({isOK:!1});var c=i.config&&i.config.chip?i.config.chip:[];e.setState({localChipList:c},(function(){e.setState({isOK:!0});var t=Object(o.a)({},a),i=L(n,t);i.config=Object(o.a)(Object(o.a)({},i.config),{},{chip:Object(O.a)(c)}),ce(t)}))},e.getSignature=function(e){var t,n=[],a=Object(T.a)(Object.keys(e).sort());try{for(a.s();!(t=a.n()).done;){var i=t.value;e[i]&&("signature"!==i&&("object"==typeof e[i]?n.push("".concat(i,"=").concat(JSON.stringify(e[i]))):n.push("".concat(i,"=").concat(e[i]))))}}catch(c){a.e(c)}finally{a.f()}return n.push("Ifeng888"),W(n.join("&")).toUpperCase()},e.createChip=Object(jt.a)(bt.a.mark((function t(){var n,a,i,c,r,s,o,l,d,p,h,u,g,f,m,x;return bt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.props.dataMap,a=n.cname,i=n.channel,c=e.state,r=c.newChip,s=r.chipId,o=r.chipType,l=r.chipData,d=c.newChip,!s){t.next=11;break}p=e.state.localChipList,(h=Object(O.a)(p)).push(d),e.setState({localChipList:h,newChip:{chipId:"",chipType:"",chipData:{}}},e.updateChip),j.b.success("\u6dfb\u52a0\u6210\u529f"),t.next=21;break;case 11:if(i.id){t.next=14;break}return j.b.warn("\u8fd8\u6ca1\u6307\u5b9a\u9891\u9053\uff0c\u521b\u5efa\u5931\u8d25"),t.abrupt("return");case 14:return u=l.title,(g={name:"".concat(i.name,"-").concat(a,"-from Split-").concat(u),channel:i.id,channelName:i.name,content:void 0}).signature=e.getSignature(g),t.next=19,b.a.post(Gt[o],g);case 19:0===(f=t.sent).data.code?(m=e.state.localChipList,(x=Object(O.a)(m)).push({chipId:f.data.data,chipType:o,chipData:l}),e.setState({localChipList:x,newChip:{chipId:"",chipType:"",chipData:{}}},e.updateChip),j.b.success("\u521b\u5efa\u6210\u529f")):j.b.error("\u521b\u5efa\u788e\u7247\u5931\u8d25");case 21:case"end":return t.stop()}}),t)}))),e.updateChip=function(){var t=e.props,n=t.activeId,a=t.dataMap,i=e.state.localChipList,c=Object(o.a)({},a),r=L(n,c);r.config=Object(o.a)(Object(o.a)({},r.config),{},{chip:i}),ce(c)},e.changeNewChip=function(t){e.setState({newChip:t})},e.changeLocalChipList=function(t,n){var a=e.state.localChipList,i=Object(O.a)(a);t?i.splice(n,1,t):i.splice(n,1),e.setState({localChipList:i},e.updateChip)},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.initAndUpdate()}},{key:"componentDidUpdate",value:function(e,t,n){e.activeId!==this.props.activeId&&this.initAndUpdate()}},{key:"render",value:function(){var e=this,t=this.state,n=t.localChipList,a=t.newChip;return Object(w.jsxs)(Ht,{children:[Object(w.jsx)(St.a,{ghost:!0,style:n.length>0?{fontSize:"12px",marginBottom:"16px"}:{fontSize:"12px"},children:this.state.isOK&&n.map((function(t,n){return Object(w.jsx)(St.a.Panel,{header:Object(w.jsxs)("div",{className:"collapseTitle",children:[Object(w.jsxs)("strong",{children:[t.chipId," - ",t.chipType]}),Object(w.jsx)("span",{children:t.chipData.name})]}),children:Object(w.jsx)("div",{children:Object(w.jsx)(Vt,{index:n,chip:Object(o.a)({},t),onChange:function(t){return e.changeLocalChipList(t,n)},onDelete:function(){return e.changeLocalChipList(void 0,n)}})})},n)}))}),Object(w.jsx)("div",{className:"title",children:"\u65b0\u589e\u788e\u7247"}),Object(w.jsx)(Vt,{isNew:!0,chip:a,onChange:this.changeNewChip,onAdd:this.createChip})]})}}]),n}(a.PureComponent);var Xt,$t,qt=Object(s.b)((function(e){return{activeId:e.activeId,dataMap:e.dataMap}}))(Jt),Yt=n(530),Qt=le.a.span(Xt||(Xt=Object(oe.a)(["\n  display: inline-flex;\n  align-items: center;\n  transition: color .3s;\n  cursor: grab;\n  user-select: none;\n\n  &:hover {\n    color: #1890ff;\n  }\n\n  &:active {\n    cursor: grabbing;\n  }\n"]))),Zt=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).copy=function(){var t=document.createElement("input");t.value=e.props.children.toString(),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),j.b.success("\u590d\u5236\u6210\u529f")},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props.children;return Object(w.jsxs)(Qt,{onClick:this.copy,children:[e,Object(w.jsx)(k,{icon:"copy",color:"#1890ff",style:{fontSize:"12px",marginLeft:"2px"}})]})}}]),n}(a.PureComponent),en=Zt,tn=le.a.div($t||($t=Object(oe.a)(["\n  cursor: default;\n  \n  .settingTitle {\n    display: flex;\n    align-items: center;\n      \n    i {\n      margin-right: 4px;\n    }\n  }\n  \n  .settingItem {\n    display: flex;\n    align-items: center;\n    margin: 4px 0;\n    \n    .prop {\n      margin-right: 4px;\n      cursor: help;\n      \n      &:hover {\n        text-decoration: underline dashed;\n      }\n    }\n  }\n  \n"]))),nn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={bcScale:100},e.handleBcScaleChange=function(t){var n=e.props.dataMap,a=Object(o.a)({},n);a.bc.scale=t/100,ce(a),e.setState({bcScale:t}),window.app.stage.children.find((function(e){return"bc"===e.name})).setTransform(0,0,t/100,t/100)},e.updateName=function(t,n){var a=e.props.dataMap,i=Object(o.a)({},a);"en"===t&&(i.name=n),"cn"===t&&(i.cname=n),ce(i)},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.dataMap;this.setState({bcScale:Math.round(100*e.bc.scale)})}},{key:"componentDidUpdate",value:function(e,t,n){e.dataMap!==this.props.dataMap&&this.setState({bcScale:Math.round(100*this.props.dataMap.bc.scale)})}},{key:"render",value:function(){var e=this,t=this.props,n=t.env,a=t.trackProjectId,i=t.dataMap,c=this.state.bcScale,r=i.name,s=i.cname,o=i.bc;return Object(w.jsxs)(tn,{children:[Object(w.jsxs)("h2",{className:"settingTitle",children:[Object(w.jsx)(k,{icon:"setting"}),"\u9879\u76ee\u8bbe\u7f6e"]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{children:"\u57fa\u7840\u8bbe\u7f6e"}),Object(w.jsxs)("div",{children:[Object(w.jsxs)("div",{className:"settingItem",children:[Object(w.jsx)(x.a,{placement:"left",title:"\u9879\u76ee\u7684\u82f1\u6587\u540d\u79f0",children:Object(w.jsx)("span",{className:"prop",children:"\u9879\u76ee\u540d\u79f0:"})}),Object(w.jsx)(at,{inputStyle:{width:"160px",fontSize:"12px"},size:"small",onChange:function(t){return e.updateName("en",t)},children:r})]}),Object(w.jsxs)("div",{className:"settingItem",children:[Object(w.jsx)(x.a,{placement:"left",title:"\u9879\u76ee\u7684".concat("default"===n?"\u4e2d\u6587\u540d\u79f0":"\u8def\u5f84"),children:Object(w.jsxs)("span",{className:"prop",children:["default"===n?"\u9879\u76ee\u4e2d\u6587\u540d\u79f0":"\u9879\u76ee\u8def\u5f84",":"]})}),Object(w.jsx)(at,{readOnly:0===n.indexOf("custom"),inputStyle:{width:"160px",fontSize:"12px"},size:"small",onChange:function(t){return e.updateName("cn",t)},children:s})]}),Object(w.jsxs)("div",{className:"settingItem",children:[Object(w.jsx)(x.a,{placement:"left",title:Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{children:"\u57cb\u70b9\u6240\u5c5e\u7684\u57cb\u70b9\u9879\u76ee"}),Object(w.jsx)("br",{}),Object(w.jsxs)("span",{style:{fontWeight:"lighter"},children:["\u9996\u6b21\u521b\u5efa\u57cb\u70b9\u65f6\u81ea\u52a8\u521b\u5efa\u3002",Object(w.jsx)("span",{style:{fontWeight:"bold"},children:"\u521b\u5efa\u540e\u4e0d\u53ef\u4fee\u6539"}),"\u3002"]})]}),children:Object(w.jsx)("span",{className:"prop",children:"\u57cb\u70b9\u9879\u76ee:"})}),a?Object(w.jsx)("span",{style:{fontFamily:"monospace",fontStyle:"italic"},children:Object(w.jsx)(en,{children:a})}):Object(w.jsx)("span",{style:{color:"#8b8b8b"},children:"\u9996\u6b21\u521b\u5efa\u57cb\u70b9\u65f6\u81ea\u52a8\u521b\u5efa"})]})]})]}),o.image&&Object(w.jsxs)("div",{children:[Object(w.jsx)("h3",{style:{marginTop:"16px"},children:"\u80cc\u666f\u56fe\u7ba1\u7406"}),Object(w.jsx)("div",{children:Object(w.jsxs)("div",{className:"settingItem",style:{alignItems:"flex-start"},children:[Object(w.jsx)(x.a,{placement:"left",title:Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{children:"\u4fee\u6539\u80cc\u666f\u56fe\u7684\u7f29\u653e\u6bd4"}),Object(w.jsx)("br",{}),Object(w.jsx)("span",{style:{fontWeight:"lighter"},children:"\u53ea\u4f5c\u7528\u4e8e\u80cc\u666f\u56fe\uff0c\u4e0d\u4f1a\u4fee\u6539\u8282\u70b9\u56fe\u5f62\u7684\u5927\u5c0f\u3002"})]}),children:Object(w.jsx)("span",{className:"prop",children:"\u80cc\u666f\u56fe\u5927\u5c0f:"})}),Object(w.jsxs)("div",{className:"flex",style:{marginTop:"-6px"},children:[Object(w.jsx)(Yt.a,{value:c,tipFormatter:function(e){return e+"%"},min:1,marks:{25:"25%",50:"50%",75:"75%",100:"100%"},style:{width:"160px"},onChange:this.handleBcScaleChange}),Object(w.jsxs)("span",{style:{margin:"-16px 0 0 16px",fontWeight:"bold"},children:[c,"%"]})]})]})})]})]})}}]),n}(a.PureComponent);var an,cn,rn=Object(s.b)((function(e){return{env:e.env,trackProjectId:e.trackProjectId,dataMap:e.dataMap}}))(nn),sn=le.a.div(an||(an=Object(oe.a)(["\n\n  &:hover {\n    .preWp {\n      padding: 0 12px 0 24px;\n      background-color: #3e3c3d;\n      color: white;\n    }\n  }\n\n  .preWp {\n    position: relative;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    background-color: #f5f5f5;\n    height: 32px;\n    margin: 2px 0;\n    padding: 0 12px;\n    cursor: pointer;\n    transition: padding .3s;\n    user-select: none;\n    \n    &::before {\n      content: '';\n      position: absolute;\n      left: 0;\n      height: 100%;\n      width: 0;\n      background-color: #1890ff;\n      transition: width ease-in .1s;\n    }\n\n    &.active {\n      &::before {\n        width: 4px;\n      }\n    }\n\n    .name {\n\n    }\n\n    .desc {\n      font-weight: lighter;\n    }\n  }\n"]))),on=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).handleClick=function(){var t=e.props,n=t.type,a=t.name,i=t.isActive;(0,t.onChange)(n,a,i)},e.jumpToMore=function(e){var t=e.currentTarget.dataset.url;window.open(t)},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props,t=e.type,n=e.name,a=e.desc,i=e.img,c=e.moreUrl,r=e.isActive;return Object(w.jsx)(sn,{children:Object(w.jsx)(ue.a,{placement:"left",align:{offset:[0,0]},autoAdjustOverflow:!0,overlayClassName:"noPaddingPopover",content:Object(w.jsx)("img",{style:{objectFit:"cover",imageRendering:"-webkit-optimize-contrast",cursor:"zoom-in",width:"".concat("pc"===t?384:187,"px"),height:"".concat("pc"===t?216:333,"px")},className:t,"data-url":c,alt:n,src:i,onClick:this.jumpToMore}),children:Object(w.jsxs)("div",{className:"preWp ".concat(r?"active":""),onClick:this.handleClick,children:[Object(w.jsx)("span",{className:"name",children:n}),Object(w.jsx)("span",{className:"desc",children:a})]})})})}}]),n}(a.PureComponent),ln=on,dn=le.a.div(cn||(cn=Object(oe.a)(["\n  height: 100%;\n  overflow: auto;\n  \n  .propsList {\n\n    .props {\n      position: relative;\n      padding: 1px 0 1px 20px;\n      transition: all .3s;\n      cursor: default;\n      \n      &.custom {\n        padding: 2px 0 2px 20px;\n      }\n\n      &:hover {\n        background-color: #f3f3f3;\n        \n        .delete {\n          display: inline;\n        }\n\n        .decoration {\n          color: #929292;\n        }\n      }\n\n      .decoration {\n        font-size: 12px;\n        color: #cccccc;\n        transition: all .3s;\n      }\n      \n      .delete {\n        position: absolute;\n        top: 3px;\n        left: 10px;\n        font-size: 12px;\n        display: none;\n        cursor: pointer;\n        \n        &:hover {\n          color: red;\n        }\n      }\n\n      .propKey {\n        cursor: pointer;\n        color: black;\n        \n        &:hover {\n          color: #3490FF;\n        }\n      }\n\n      .colon {\n        margin: 0 4px 0 2px;\n      }\n      \n      .customType {\n        font-size: 12px;\n        cursor: pointer;\n        \n        &:hover {\n          color: #3490FF;\n        }\n      }\n    }\n\n    &::before {\n      content: 'static propTypes = {';\n      font-size: 12px;\n      color: #cccccc;\n    }\n\n    &::after {\n      content: '}';\n      font-size: 12px;\n      color: #cccccc;\n    }\n  }\n  \n  .addBtns {\n    display: flex;\n    font-size: 12px;\n    align-items: center;\n    margin-top: 6px;\n    \n    & button {\n      margin: 0 4px;\n      padding: 0 12px;\n      font-size: 12px;\n      border-radius: 20px;\n      width: 80px;\n    }\n  }\n  \n  .pre {\n    margin-top: 20px;\n    \n    .preTitle {\n      color: rgba(0, 0, 0, 0.85);\n      font-weight: 500;\n      margin: 0;\n      font-size: 14px;\n      \n      .icon {\n        margin-left: 4px;\n        cursor: pointer;\n      }\n    }\n\n    .ant-collapse-header {\n      padding: 6px 4px;\n      user-select: none;\n      display: flex;\n      align-items: center;\n\n      .ant-collapse-arrow {\n        font-size: 10px;\n      }\n    }\n    \n    .collapseTitle {\n      width: 100%;\n      display: inline-flex;\n      align-items: center;\n      justify-content: space-between;\n      padding-right: 12px;\n      \n      strong {\n        margin: 0 2px;\n      }\n    }\n  }\n"]))),pn=xe.a.Option,hn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={propsList:[],preComponent:[],editingKey:null,editingValue:null},e.update=function(){var t=e.props,n=t.activeId,a=t.dataMap,i=L(n,a),c=i.config&&i.config.component?i.config.component:{props:[],preComponent:[]};e.setState({propsList:c.props,preComponent:c.preComponent},(function(){var e=Object(o.a)({},a),t=L(n,e);t.config=Object(o.a)(Object(o.a)({},t.config),{},{component:Object(o.a)({},c)}),ce(e)}))},e.editKey=function(t){var n=t.currentTarget.dataset,a=n.index,i=n.value;e.setState({editingKey:{index:+a,value:i}})},e.editValue=function(t){var n=t.currentTarget.dataset,a=n.index,i=n.value;e.setState({editingValue:{index:+a,value:i}})},e.changeKey=function(t){var n=e.state,a=n.propsList,i=n.editingKey,c=Object(O.a)(a),r=t.target.value;c[i.index].key=r,e.updatePropsToDataMap(c)},e.changeValue=function(t){var n=e.state,a=n.propsList,i=n.editingValue,c=Object(O.a)(a),r=t.target.value;c[i.index].customType=r,e.updatePropsToDataMap(c)},e.deleteKey=function(t,n){var a,i=e.state.propsList;a=void 0!==n?n:+t.target.dataset.index;var c=Object(O.a)(i);c.splice(a,1),e.updatePropsToDataMap(c)},e.editType=function(t,n){var a=e.state.propsList,i=Object(O.a)(a);i[t].type=n,e.setState({propsList:i})},e.handleEnter=function(t){e.editKey(t),e.setState({editingKey:null})},e.selectAll=function(t){t.currentTarget.select(),document.addEventListener("mousedown",e.cancelEdit)},e.cancelEdit=function(t){var n=e.state,a=n.propsList,i=n.editingKey,c=n.editingValue;if(i){if("editComponentPropKey"===t.target.id)return;a[i.index].key||e.deleteKey(null,i.index),e.setState({editingKey:null})}if(c){if("editComponentPropValue"===t.target.id)return;e.setState({editingValue:null})}document.removeEventListener("mousedown",e.cancelEdit)},e.add=function(t){var n=t.currentTarget.dataset.type,a=e.state.propsList,i=Object(O.a)(a);"normal"===n?i.push({key:"",type:"any"}):i.push({key:"",customType:"PropTypes.any"}),e.setState({propsList:i,editingKey:{index:i.length-1,value:""}})},e.updatePropsToDataMap=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a={};t&&(a.props=t,e.setState({propsList:t})),n&&(a.preComponent=n,e.setState({preComponent:n}));var i=e.props,c=i.activeId,r=i.dataMap,s=Object(o.a)({},r),l=L(c,s);l.config=Object(o.a)(Object(o.a)({},l.config),{},{component:Object(o.a)(Object(o.a)({},l.config.component),a)}),ce(s)},e.handlePreComponentChange=function(t,n,a){var i=e.state.preComponent,c=Object(O.a)(i);if(a){var r=c.findIndex((function(e){return e.type===t&&e.name===n}));c.splice(r,1)}else c.push({name:n,type:t});e.updatePropsToDataMap(void 0,c)},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){this.update()}},{key:"componentDidUpdate",value:function(e,t,n){e.activeId!==this.props.activeId&&this.update()}},{key:"render",value:function(){var e=this,t=this.state,n=t.propsList,a=t.editingKey,i=t.editingValue,c=t.preComponent;return Object(w.jsxs)(dn,{children:[Object(w.jsx)("div",{className:"propsList",children:n.map((function(t,c){return Object(w.jsxs)("div",{className:"props",children:[Object(w.jsx)("span",{className:"delete","data-index":c,onClick:e.deleteKey,children:"-"}),a&&a.index===c?Object(w.jsx)(ge.a,{size:"small",id:"editComponentPropKey",autoFocus:!0,defaultValue:a.value,style:{width:"100px"},onChange:e.changeKey,onFocus:e.selectAll,onPressEnter:e.handleEnter}):Object(w.jsx)("span",{className:"propKey","data-index":c,"data-value":t.key,onClick:e.editKey,children:t.key}),Object(w.jsx)("span",{className:"colon decoration",children:":"}),t.type?Object(w.jsxs)("span",{className:"type ".concat(t.customType?"custom":""),children:[Object(w.jsx)("span",{className:"decoration",children:"PropTypes."}),Object(w.jsxs)(xe.a,{value:t.type,size:"small",style:{width:"90px"},onChange:function(t){return e.editType(c,t)},children:[Object(w.jsx)(pn,{value:"string",children:"string"}),Object(w.jsx)(pn,{value:"number",children:"number"}),Object(w.jsx)(pn,{value:"bool",children:"bool"}),Object(w.jsx)(pn,{value:"func",children:"func"}),Object(w.jsx)(pn,{value:"object",children:"object"}),Object(w.jsx)(pn,{value:"array",children:"array"}),Object(w.jsx)(pn,{value:"element",children:"element"}),Object(w.jsx)(pn,{value:"any",children:"any"})]})]}):i&&i.index===c?Object(w.jsx)(ge.a.TextArea,{size:"small",id:"editComponentPropValue",style:{fontSize:"12px"},autoFocus:!0,cols:2,defaultValue:i.value,onChange:e.changeValue,onFocus:e.selectAll,onPressEnter:e.handleEnter}):Object(w.jsx)("span",{className:"customType","data-index":c,"data-value":t.customType,onClick:e.editValue,children:t.customType}),c<n.length-1&&Object(w.jsx)("span",{className:"decoration",style:{marginLeft:"4px"},children:","})]},c)}))}),Object(w.jsxs)("div",{className:"addBtns",children:[Object(w.jsx)("span",{children:"\u6dfb\u52a0 propTypes\uff1a"}),Object(w.jsx)(v.a,{type:"primary",size:"small","data-type":"normal",onClick:this.add,children:"\u57fa\u7840"}),Object(w.jsx)(v.a,{type:"primary",size:"small",ghost:!0,"data-type":"custom",onClick:this.add,children:"\u81ea\u5b9a\u4e49"})]}),Object(w.jsxs)("div",{className:"pre",children:[Object(w.jsxs)("span",{className:"preTitle",children:[Object(w.jsx)("span",{children:"\u9884\u8bbe\u7ec4\u4ef6"}),Object(w.jsx)(x.a,{title:"\u9009\u62e9\u82e5\u5e72\u4e2a\u7ec4\u4ef6\uff0c\u7136\u540e\u6211\u4eec\u4f1a\u5728\u6587\u4ef6\u4e2d\u628a\u5b83\u4eec\u5f15\u5165\u5e76\u521d\u59cb\u5316",children:Object(w.jsx)("span",{className:"icon",children:Object(w.jsx)(k,{icon:"help",color:"#787878",style:{fontSize:"16px"}})})})]}),Object(w.jsxs)(St.a,{defaultActiveKey:["1","2"],ghost:!0,style:{fontSize:"12px"},children:[Object(w.jsx)(St.a.Panel,{header:Object(w.jsxs)("div",{className:"collapseTitle",children:[Object(w.jsxs)("span",{children:[Object(w.jsx)(k,{icon:"pc",style:{fontSize:"14px",marginRight:"4px"}}),"PC\u7aef"]}),c.filter((function(e){return"pc"===e.type})).length>0&&Object(w.jsxs)("span",{children:["\u5df2\u9009\u62e9",Object(w.jsx)("strong",{children:c.filter((function(e){return"pc"===e.type})).length}),"\u4e2a"]})]}),children:Object(w.jsx)("div",{children:Re.pc.map((function(t,n){return Object(w.jsx)(ln,{isActive:c&&Boolean(c.filter((function(e){return"pc"===e.type})).find((function(e){return e.name===t.name}))),type:"pc",name:t.name,desc:t.desc,img:t.img,moreUrl:t.moreUrl,onChange:e.handlePreComponentChange},n)}))})},"1"),Object(w.jsx)(St.a.Panel,{header:Object(w.jsxs)("div",{className:"collapseTitle",children:[Object(w.jsxs)("span",{children:[Object(w.jsx)(k,{icon:"mobile",style:{fontSize:"14px",marginRight:"4px"}}),"\u79fb\u52a8\u7aef"]}),c.filter((function(e){return"mobile"===e.type})).length>0&&Object(w.jsxs)("span",{children:["\u5df2\u9009\u62e9",Object(w.jsx)("strong",{children:c.filter((function(e){return"mobile"===e.type})).length}),"\u4e2a"]})]}),children:Object(w.jsx)("div",{children:Re.mobile.map((function(t,n){return Object(w.jsx)(ln,{isActive:c&&Boolean(c.filter((function(e){return"mobile"===e.type})).find((function(e){return e.name===t.name}))),type:"mobile",name:t.name,desc:t.desc,img:t.img,moreUrl:t.moreUrl,onChange:e.handlePreComponentChange},n)}))})},"2")]})]})]})}}]),n}(a.PureComponent);var un,gn=Object(s.b)((function(e){return{activeId:e.activeId,dataMap:e.dataMap}}))(hn),bn=le.a.div(un||(un=Object(oe.a)(["\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 1px;\n  height: 100%;\n  z-index: ",";\n  background-color: #e5e5e5;\n  cursor: pointer;\n  transition: all .3s;\n  \n  &::after {\n    content: '';\n    position: absolute;\n    width: 8px;\n    height: 100%;\n    left: -3px;\n    top: 0;\n    z-index: -1;\n  }\n  \n  &:hover {\n    cursor: col-resize;\n    background-color: #3e3c3d;\n    width: ","px;\n  }\n"])),(function(e){return e.isTop?5:4}),(function(e){return e.isTop?2:1})),jn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).startMove=function(t){var n=e.props,a=n.onChange,i=n.max,c=n.min,r=t.clientX,s=function(t){t.preventDefault();var n=e.props.width,s=t.clientX,o=n-s+r;o<=i&&o>=c&&(a(n-s+r),r=s)};document.addEventListener("mousemove",s,!1),document.addEventListener("mouseup",(function(){document.removeEventListener("mousemove",s,!1),document.removeEventListener("mouseup",s,!1)}),!1)},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props.isTop;return Object(w.jsx)(bn,{isTop:e,onMouseDown:this.startMove})}}]),n}(a.PureComponent);jn.defaultProps={isTop:!1,max:Number.MAX_VALUE,min:-1};var fn,mn=jn,xn=le.a.div(fn||(fn=Object(oe.a)(["\n  position: absolute;\n  right: 0;\n  height: 100%;\n  background-color: #ffffff;\n  padding: 4px 0 0;\n  z-index: 3;\n  \n  .propertyWp {\n    position: relative;\n    height: 100%;\n    padding: 0 10px 0;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-between;\n    font-size: 12px;\n    z-index: 3;\n\n    .property {\n      height: 100%;\n    }\n    \n    .ant-tabs-nav {\n      margin-bottom: 0;\n    }\n    \n    .ant-tabs-content-holder {\n      height: 100%;\n      overflow: auto;\n      padding-top: 12px;\n    }\n\n    .ant-form-item {\n      margin-bottom: 12px;\n    }\n\n    .ant-form-item-label > label {\n      font-size: 12px;\n    }\n\n    .ant-radio + span {\n      font-size: 12px;\n    }\n\n    .ant-select-selection-item {\n      font-size: 12px;\n    }\n    \n    .breadcrumb {\n      white-space: nowrap;\n      overflow: auto hidden;\n      \n      .ant-breadcrumb > span {\n        display: inline-flex;\n        align-items: center;\n\n        .ant-breadcrumb-link {\n          display: inline-flex;\n          align-items: center;\n          cursor: pointer;\n          font-size: 12px;\n          height: 24px;\n          border-radius: 4px;\n          padding-right: 1px;\n\n          &:hover {\n            background-color: #f5f5f5;\n          }\n        }\n        \n        .ant-breadcrumb-separator {\n          margin: 0 4px;\n          font-size: 12px;\n        }\n      }\n    }\n  }\n\n  .ant-tabs-tab {\n\n    & + .ant-tabs-tab {\n      margin-left: 20px;\n    }\n  }\n\n  .tabDiv {\n    position: relative;\n    padding: 0 4px 0;\n\n    &.active::after {\n      content: '';\n      position: absolute;\n      top: 0;\n      right: -4px;\n      width: 6px;\n      height: 6px;\n      border: solid 1px #575757;\n      border-radius: 50%;\n      transition: opacity ease-in-out .3s;\n      animation: colorChange 2s infinite ease-in-out;\n    }\n  }\n\n  .btnBox {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    margin-top: 16px;\n\n    button {\n      margin: 0 4px;\n      padding: 0 12px;\n      font-size: 12px;\n      border-radius: 20px;\n      width: 80px;\n      line-height: 12px;\n    }\n  }\n\n  @keyframes colorChange {\n    0% {\n      background-color: #d5ffe3;\n    }\n\n    50% {\n      background-color: #57ef85;\n    }\n\n    100% {\n      background-color: #d5ffe3;\n    }\n  }\n"]))),vn=Le.a.TabPane,On=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={widthPercent:.6,activeKey:1},e.handleActiveKeyChange=function(t){return e.setState({activeKey:t})},e.handleWidthChange=function(t){var n=t/e.props.settingWidth;e.setState({widthPercent:n})},e.getWidth=function(){var t=e.state.widthPercent,n=e.props.settingWidth*t;return n>300?n:300},e.getPath=function(){var t=e.props,n=t.activeId,a=t.dataMap,i=[];if(""!==n&&"0"!==n)for(var c=n.split("_"),r=0;r<c.length;r++){var s=L(c.slice(0,r+1).join("_"),a);if(s){var o="";s.config&&s.config.component&&function(){var e=s.config.component.preComponent,t=e.filter((function(e){return"pc"===e.type})),n=e.filter((function(e){return"mobile"===e.type}));t.length+n.length>1?o="div":(n.length>0&&(o=Re.mobile.find((function(e){return e.name===n[0].name})).icon),t.length>0&&(o=Re.pc.find((function(e){return e.name===t[0].name})).icon))}(),i.push({id:s.id,icon:o||"div",name:s.name,color:s.color})}}return Object(w.jsxs)(ut.a,{separator:">",children:[Object(w.jsx)(ut.a.Item,{onClick:function(){return Q("0")},children:Object(w.jsx)(k,{icon:"all"})}),i.map((function(e,t){return Object(w.jsxs)(ut.a.Item,{onClick:function(){return Q(e.id)},children:[Object(w.jsx)(k,{icon:e.icon,color:e.color}),e.name]},t)}))]})},e}return Object(d.a)(n,[{key:"render",value:function(){var e=this.state.activeKey,t=this.props,n=t.settingWidth,a=t.activeId,i=t.dataMap,c=this.getWidth(),r=L(a,i);return Object(w.jsxs)(xn,{style:{width:c+"px"},children:[Object(w.jsx)(mn,{width:c,min:300,max:Math.max(.4*n,n-200),onChange:this.handleWidthChange}),Object(w.jsxs)("div",{className:"propertyWp",children:[Object(w.jsx)("div",{className:"property",children:a&&Object(w.jsxs)(w.Fragment,{children:["0"===a&&Object(w.jsx)("div",{style:{borderBottom:"solid 1px #e5e5e5",paddingBottom:"10px",marginBottom:"10px"},children:Object(w.jsx)(rn,{})}),Object(w.jsxs)(Le.a,{size:"small",defaultActiveKey:e,style:{height:"100%"},onChange:this.handleActiveKeyChange,children:[Object(w.jsx)(vn,{tab:Object(w.jsx)("div",{className:"tabDiv",children:"\u7ec4\u4ef6"}),children:Object(w.jsx)(gn,{},a)},"1"),Object(w.jsx)(vn,{tab:Object(w.jsx)("div",{className:"tabDiv ".concat(r&&r.config&&r.config.track&&r.config.track.trackId?"active":""),children:"\u57cb\u70b9"}),children:Object(w.jsx)(It,{},a)},"2"),Object(w.jsx)(vn,{tab:Object(w.jsx)("div",{className:"tabDiv",children:"\u788e\u7247"}),children:Object(w.jsx)(qt,{},a)},"3")]})]})}),Object(w.jsx)("div",{className:"breadcrumb",children:this.getPath()})]})]})}}]),n}(a.PureComponent);var yn=Object(s.b)((function(e){return{activeId:e.activeId,settingWidth:e.settingWidth,dataMap:e.dataMap}}))(On),wn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(d.a)(n,[{key:"render",value:function(){var e=this.props.settingWidth;return Object(w.jsxs)("div",{style:{width:"".concat(e,"px"),display:"flex",height:"100%"},children:[Object(w.jsx)(mn,{isTop:!0,width:e,min:300,onChange:te}),Object(w.jsx)(ht,{}),Object(w.jsx)(yn,{})]})}}]),n}(a.PureComponent);var Cn,kn=Object(s.b)((function(e){return{settingWidth:e.settingWidth}}))(wn),In=le.a.div(Cn||(Cn=Object(oe.a)(["\n  width: 450px;\n  position: absolute;\n  right: 604px;\n  top: 1px;\n  background-color: #ffffff;\n  box-shadow: 2px 2px 7px 4px rgba(229, 229, 229, 0.57);\n  border-radius: 4px;\n  z-index: 7;\n\n  .title {\n    font-size: 14px;\n    font-weight: bold;\n    margin-bottom: 12px;\n    padding: 12px 12px 0;\n  }\n  \n  .content {\n    max-height: 600px;\n    overflow: auto;\n    \n    .addWp {\n      padding: 0 12px;\n      background-color: rgba(0, 128, 0, 0.04);\n    }\n\n    .reduceWp {\n      padding: 0 12px;\n      background-color: rgba(255, 0, 0, 0.04);\n    }\n\n    .sign {\n      color: white;\n      padding: 2px 8px;\n      border-radius: 20px;\n      margin-right: 6px;\n      font-style: normal;\n\n      &.add {\n        background-color: green;\n      }\n\n      &.reduce {\n        background-color: red;\n      }\n\n      &.other {\n        background-color: gray;\n      }\n    }\n\n    .tipTitle {\n      font-size: 12px;\n      font-style: italic;\n      height: 28px;\n      line-height: 28px;\n      color: #afafaf;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n\n      .saveAll {\n        font-style: normal;\n\n        & .ant-checkbox-wrapper {\n          height: 20px;\n          line-height: 20px;\n          font-size: 12px;\n          user-select: none;\n        }\n      }\n    }\n\n    .conflict {\n      font-size: 12px;\n      padding-left: 46px;\n      height: 24px;\n      line-height: 24px;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n      transition: all .3s;\n      position: relative;\n      \n      &.disabled {\n        cursor: not-allowed;\n        pointer-events: none;\n      }\n\n      .saveTip {\n        position: absolute;\n        top: 0;\n        right: 75px;\n        color: rgba(0, 128, 0, 0.3);\n        font-style: italic;\n      }\n\n      &::before {\n        content: '';\n        position: absolute;\n        left: 30px;\n        top: 10px;\n        width: 4px;\n        height: 4px;\n        border-radius: 100%;\n        background-color: black;\n        opacity: 0;\n      }\n\n      &:hover {\n        &::before {\n          opacity: 1;\n          transition: opacity ease-out .2s;\n        }\n      }\n\n      & button {\n        font-size: 12px;\n        margin-right: 4px;\n        width: 20px;\n      }\n\n      .btn {\n        cursor: pointer;\n        padding: 4px 6px;\n        border-radius: 5px;\n        transition: all .3s;\n\n        &.primary {\n          color: green;\n        }\n\n        &.danger {\n          color: #ff4b4b;\n        }\n\n        &:hover, &.active {\n          background-color: rgba(193, 193, 193, .3);\n\n          &.primary {\n            background-color: rgba(121, 231, 60, .3);\n          }\n\n          &.danger {\n            background-color: rgba(253, 181, 181, 0.3);\n          }\n        }\n      }\n    }\n\n    .extra {\n      font-size: 12px;\n      padding: 0 12px;\n      background-color: rgba(204, 204, 204, 0.18);\n      height: 32px;\n      line-height: 32px;\n    }\n  }\n\n  .footer {\n    text-align: right;\n    margin-top: 10px;\n    padding: 0 12px 12px;\n  }\n"]))),Sn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={isConflict:!1,changeList:{add:[],reduce:[],infoChange:[]},finishLoading:!1,isAddSaveAll:!0},e.changeStatus=function(t){var n=e.state.changeList,a=t.currentTarget.dataset,i=a.group,c=a.id,r=a.status,s=n[i].slice();s.find((function(e){return e.chipId===c})).status=r,e.setState({changeList:Object(o.a)(Object(o.a)({},n),{},Object(m.a)({},i,s))})},e.save=function(t,n){var a=e.state.changeList,i=a.add.slice();i.find((function(e){return e.chipId===t})).status=n,e.setState({changeList:Object(o.a)(Object(o.a)({},a),{},{add:i})})},e.finish=function(){e.setState({finishLoading:!0});var t=e.state.changeList,n=t.add,a=t.reduce,i=t.infoChange,c=e.props.dataMap,r=Object(o.a)({},c);for(var s in n){var l=n[s];if(l.status&&"delete"!==l.status){var d=L(l.status,r);d.config=Object(o.a)(Object(o.a)({},d.config||{}),{},{chip:[].concat(Object(O.a)(d.config&&d.config.chip||[]),[{chipType:l.chipType,chipId:l.chipId,chipData:l.chipData}])})}}var p=function(e){var t=a[e];if("delete"===t.status){var n=L(t.id,r),i=n.config.chip.findIndex((function(e){return e.chipId===t.chipId}));n.config.chip.splice(i,1)}};for(var h in a)p(h);var u=function(e){var t=i[e],n=L(t.id,r).config.chip.find((function(e){return e.chipId===t.chipId}));n.chipData.title=t.chipData.title,n.chipData.name=t.chipData.name};for(var g in i)u(g);ce(r),ae(!1),j.b.success("\u51b2\u7a81\u89e3\u51b3\u6210\u529f"),e.setState({finishLoading:!1,isConflict:!1})},e.getStatusPercent=function(){var t=e.state.changeList,n=t.add,a=t.reduce,i=n.concat(a);return i.filter((function(e){return!!e.status})).length/i.length},e.toggleIsAddSaveAll=function(e){e.target.checked},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e,t=this.props,n=t.splitChip,a=t.allDataChip,i=n.map((function(e){return e.chipId})),c=a.map((function(e){return e.chipId})),r=a.filter((function(e){return!i.includes(e.chipId)})),s=[],l=[],d=Object(T.a)(n);try{var p=function(){var t=e.value;if(c.includes(t.chipId)){var n=a.find((function(e){return e.chipId===t.chipId}));t.chipData.name===n.chipData.name&&t.chipData.title===n.chipData.title||l.push(Object(o.a)(Object(o.a)({},n),{},{id:t.id}))}else s.push(t)};for(d.s();!(e=d.n()).done;)p()}catch(h){d.e(h)}finally{d.f()}0===r.length&&0===s.length&&0===l.length?this.setState({isConflict:!1}):(this.setState({changeList:{add:r,reduce:s,infoChange:l},isConflict:!0}),ae(!0))}},{key:"render",value:function(){var e=this,t=this.state,n=t.isConflict,a=t.changeList,i=a.add,c=a.reduce,r=a.infoChange,s=t.finishLoading,o=t.isAddSaveAll;if(!n)return null;var l=this.getStatusPercent();return Object(w.jsxs)(In,{children:[Object(w.jsxs)("div",{className:"title",children:["\u68c0\u6d4b\u5230",Object(w.jsx)("span",{className:"code",children:"config_split.js"}),"\u548c config.js \u4e2d\u7684",Object(w.jsx)("span",{className:"code",children:"allData"}),"\u5b58\u5728\u788e\u7247\u51b2\u7a81\uff1a"]}),Object(w.jsxs)("div",{className:"content",children:[i.length>0&&Object(w.jsxs)("div",{className:"addWp",children:[Object(w.jsxs)("div",{className:"tipTitle",children:[Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"sign add",children:"\u65b0\u589e"}),"\u8fd9\u4e9b\u662f allData \u91cc\u65b0\u589e\u7684\uff0c\u5efa\u8bae\u4fdd\u7559"]}),Object(w.jsx)("div",{className:"saveAll",children:Object(w.jsx)(Be.a,{checked:o,onChange:this.toggleIsAddSaveAll,children:"\u5168\u90e8\u4fdd\u7559\u5230\u6839\u8282\u70b9"})})]}),i.map((function(t,n){return Object(w.jsxs)("div",{className:"conflict",children:[t.chipId," - ",t.chipType," (",t.chipData.title,")",t.status&&"delete"!==t.status&&Object(w.jsxs)("div",{className:"saveTip",children:["\u4fdd\u7559\u81f3\uff1a",L(t.status).name]}),Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"btn ".concat("delete"===t.status?"active":""),"data-group":"add","data-id":t.chipId,"data-status":"delete",onClick:e.changeStatus,children:"\u5220\u9664"}),Object(w.jsx)(ue.a,{placement:"right",content:Object(w.jsxs)("div",{style:{width:"250px"},children:[Object(w.jsx)("div",{style:{fontSize:"12px",marginBottom:"4px"},children:"\u9009\u62e9\u8981\u5b58\u50a8\u4fe1\u606f\u7684\u8282\u70b9\uff1a"}),Object(w.jsx)(At,{height:300,value:"delete"===t.status?void 0:t.status,onChange:function(n){return e.save(t.chipId,n)}})]}),trigger:["click"],children:Object(w.jsx)("span",{className:"btn primary ".concat(t.status&&"delete"!==t.status?"active":""),"data-group":"add","data-id":t.chipId,"data-status":"save",children:"\u4fdd\u7559"})})]})]},n)}))]}),c.length>0&&Object(w.jsxs)("div",{className:"reduceWp",children:[Object(w.jsxs)("div",{className:"tipTitle",children:[Object(w.jsx)("span",{className:"sign reduce",children:"\u51cf\u5c11"}),"\u8fd9\u4e9b\u662f split_split.js \u91cc\u6709\u4f46\u662f allData \u91cc\u6ca1\u6709\u7684\uff0c\u5927\u6982\u7387\u6ca1\u7528\u4e86"]}),c.map((function(t,n){return Object(w.jsxs)("div",{className:"conflict",children:[t.chipId," - ",t.chipType,Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"btn ".concat("save"===t.status?"active":""),"data-group":"reduce","data-id":t.chipId,"data-status":"save",onClick:e.changeStatus,children:"\u4fdd\u7559"}),Object(w.jsx)("span",{className:"btn danger ".concat("delete"===t.status?"active":""),"data-group":"reduce","data-id":t.chipId,"data-status":"delete",onClick:e.changeStatus,children:"\u5220\u9664"})]})]},n)}))]}),r.length>0&&Object(w.jsxs)("div",{className:"extra",children:[Object(w.jsx)("span",{className:"sign other",children:"\u5176\u4ed6"}),"\u8fd8\u6709 ",Object(w.jsx)("strong",{children:r.length})," \u4e2a\u788e\u7247\u7684\u4fe1\u606f\u6709\u6539\u52a8\uff0c\u5c06\u4ee5 allData \u4e3a\u51c6\u81ea\u52a8\u66f4\u65b0"]})]}),Object(w.jsx)("div",{className:"footer",children:Object(w.jsx)(v.a,{type:"primary",ghost:1!==l,shape:"round",loading:s,onClick:this.finish,disabled:1!==l,children:"\u786e\u5b9a"})})]})}}]),n}(a.PureComponent);var Nn=Object(s.b)((function(e){return{dataMap:e.dataMap}}))(Sn),Tn=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={pointGraphics:[]},e.handlePoint=function(t,n,a){if(0===t.data.button){var i=window.app,c=e.props,r=c.mode,s=c.activeId,l=c.scale,d=c.dataMap;"choose"!==r&&F();var p=i.stage.children.find((function(e){return e.name===s})),h=L(s,d),u=e.getPoints(),g=Object(o.a)({},t.data.global),b=g.x,j=g.y;n.on("pointermove",(function(e){e.data.originalEvent.preventDefault();var t,n,i=Object(o.a)({},e.data.global),c=i.x,r=i.y,s=c-b,g=r-j,f={x:u[a].x+s/l,y:u[a].y+g/l},m=u[(a+2)%4],x=Math.abs(f.x-m.x),v=Math.abs(f.y-m.y),O=Math.min(u[a].x,u[(a+1)%4].x,u[(a+2)%4].x,u[(a+3)%4].x),y=Math.max(u[a].x,u[(a+1)%4].x,u[(a+2)%4].x,u[(a+3)%4].x),w=Math.min(u[a].y,u[(a+1)%4].y,u[(a+2)%4].y,u[(a+3)%4].y),C=Math.max(u[a].y,u[(a+1)%4].y,u[(a+2)%4].y,u[(a+3)%4].y);t=Math.min(f.x,u[(a+1)%4].x,u[(a+2)%4].x,u[(a+3)%4].x),n=Math.min(f.y,u[(a+1)%4].y,u[(a+2)%4].y,u[(a+3)%4].y),u[a].x===O&&(t=f.x>y?y:f.x),u[a].y===w&&(n=f.y>C?C:f.y),h.x=t,h.y=n,h.width=x,h.height=v,ce(d),p.clear(),p.x=t,p.y=n;var k=K(h.color);p.lineStyle(4,k,1),p.beginFill(k,.2),p.drawRect(0,0,x,v)})),n.on("pointerup",(function(){n.off("pointermove").off("pointerup").off("pointerupoutside")})),n.on("pointerupoutside",(function(){n.off("pointermove").off("pointerup").off("pointerupoutside")}))}},e.update=function(){var t=window.app,n=e.state.pointGraphics,a=e.getPoints();if(a.length>0){for(var i=[],c=function(c){var r=n[c];r||((r=new u.b).interactive=!0,r.name="point",t.stage.addChild(r),i.push(r),r.cursor=c%2===0?"nwse-resize":"nesw-resize",r.on("pointerdown",(function(t){return e.handlePoint(t,r,c)}))),r.x=a[c].x,r.y=a[c].y,r.clear();var s=e.props,o=s.activeId,l=s.dataMap,d=L(o,l),p=d.color?K(d.color):"0x000000";r.lineStyle(2,p,1),r.beginFill(16316664,1),r.drawCircle(0,0,5),r.endFill(),r.zIndex=9999},r=0;r<a.length;r++)c(r);i.length>0&&e.setState({pointGraphics:i})}else if(n[0])for(var s=0;s<4;s++)n[s].clear()},e.getPoints=function(){var t=e.props,n=t.activeId,a=t.dataMap,i=L(n,a);if(i){var c=i.x,r=i.y,s=i.width,o=i.height;return[{x:c,y:r},{x:c+s,y:r},{x:c+s,y:r+o},{x:c,y:r+o}]}return[]},e}return Object(d.a)(n,[{key:"componentWillUnmount",value:function(){var e=window.app;this.state.pointGraphics.forEach((function(t){return e.stage.removeChild(t)}))}},{key:"componentDidUpdate",value:function(e,t,n){e.activeId===this.props.activeId&&e.dataMap===this.props.dataMap||this.update()}},{key:"render",value:function(){return null}}]),n}(a.PureComponent);var zn,Mn=Object(s.b)((function(e){var t=e.mode,n=e.scale,a=e.activeId,i=e.dataMap;return{mode:t,scale:n,activeId:a,dataMap:Object(o.a)({},i)}}))(Tn),Dn=le.a.div(zn||(zn=Object(oe.a)(["\n  position: relative;\n  overflow: hidden;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n\n  .main {\n    position: relative;\n    flex: 1;\n\n    #app {\n      position: relative;\n      height: 100%;\n    }\n\n    .data {\n      position: absolute;\n      background-color: #ffffff;\n      z-index: 3;\n      right: 0;\n      top: 0;\n      height: 100%;\n    }\n\n    .freeze {\n      position: absolute;\n      left: 0;\n      top: 0;\n      width: 100%;\n      height: 100%;\n      background-color: rgba(0, 0, 0, 0.1);\n      cursor: not-allowed;\n      z-index: 6;\n    }\n  }\n"]))),An=null,En=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,i=new Array(a),c=0;c<a;c++)i[c]=arguments[c];return(e=t.call.apply(t,[this].concat(i))).state={isMoveMode:!1,isDeleting:!1,isConflictReady:!1,splitChip:[],allDataChip:[]},e.receiveMessage=function(t){if(window.location.origin!==t.origin){var n=t.data,a=n.type,i=n.isSplitEmpty,c=n.data;if("custom"===a)window.opener.postMessage({type:"received"},"*"),i?$("custom_new"):(U(c.splitConfig),$("custom")),e.compareChip(c.splitConfig,c.allData),setTimeout((function(){var t=Object(o.a)({},e.props.dataMap);t.name=c.splitConfig.name||"newProject",t.cname=c.path,ce(t),Q("0")})),console.log("\u6210\u529f",t)}},e.keyEvent=function(t){var n=e.state,a=n.isMoveMode,i=n.isDeleting,c=window.app,r=e.props,s=r.scale,l=r.activeId,d=r.parentId,p=r.dataMap;if(!["input","textarea","select","button"].includes(t.target.tagName.toLowerCase())){if((46===t.keyCode||8===t.keyCode)&&""!==l){var h=c.stage.children.find((function(e){return l===e.name})),u=Object(o.a)({},p),g=L(l,u),m=g.config&&g.config.track&&g.config.track.trackId;if(i||!m){c.stage.removeChild(h);for(var x=P(h),v=0;v<x.length;v++)c.stage.removeChild(x[v]);return l===d&&ee(""),re(l),F(),void(i&&b.a.post("http://test0.platform.ifengidc.com/platform/server/trackApi/deleteTrack",{id:g.config.track.trackId}).then((function(t){0===t.data.code&&(g.config=Object(o.a)(Object(o.a)({},g.config),{},{track:Object(o.a)(Object(o.a)({},g.config?g.config.track:{}),{},{trackId:""})}),ce(u),e.setState({isDeleting:!1}),j.b.success("\u5220\u9664\u6210\u529f"),f.a.destroy("delete"),clearTimeout(An),An=null)})))}m&&!i&&(e.setState({isDeleting:!0}),An=setTimeout((function(){e.setState({isDeleting:!1})}),5e3),f.a.warning({key:"delete",message:Object(w.jsx)("h5",{children:"\u8be5\u8282\u70b9\u5e26\u6709\u57cb\u70b9\uff0c\u5220\u9664\u8282\u70b9\u4f1a\u540c\u65f6\u5220\u9664\u57cb\u70b9\u4fe1\u606f"}),description:Object(w.jsxs)("div",{style:{fontSize:"12px"},children:[Object(w.jsx)("strong",{children:"5"})," \u79d2\u5185\u518d\u6b21\u70b9\u51fb ",Object(w.jsx)("span",{className:"key",children:"Delete"})," \u6216\u8005 ",Object(w.jsx)("span",{className:"key",children:"Backspace"})," \u7acb\u5373\u5220\u9664",Object(w.jsx)("div",{className:"progress",style:{marginTop:"4px"}})]}),duration:5,style:{width:"400px"},onClose:function(){return e.setState({isDeleting:!1})}}))}32!==t.keyCode||a||(t.stopPropagation(),F(),c.stage.children.filter((function(e){return"bc"!==e.name})).forEach((function(e){return e.interactive=!1})),c.stage.cursor="grab",e.setState({isMoveMode:!0}),c.stage.removeAllListeners(),c.stage.on("mousedown",(function(t){c.stage.cursor="grabbing";var n=Object(o.a)({},t.data.global),a=n.x,i=n.y;c.stage.on("mousemove",(function(e){var t=Object(o.a)({},e.data.global),n=t.x,r=t.y;c.stage.x+=n-a,c.stage.y+=r-i,c.stage.hitArea.x-=(n-a)/s,c.stage.hitArea.y-=(r-i)/s,a=n,i=r})),c.stage.on("mouseup",(function(){e.setState({isMoveMode:!1}),c.stage.cursor="default",c.stage.removeAllListeners()}))})),document.addEventListener("keyup",e.cancelMove))}},e.cancelMove=function(){var t=window.app;t.stage.cursor="default",e.setState({isMoveMode:!1}),t.stage.children.filter((function(e){return"bc"!==e.name})).forEach((function(e){return e.interactive=!0})),t.stage.removeAllListeners(),document.removeEventListener("keyup",e.cancelMove)},e.compareChip=function(t,n){var a=V(t),i=[],c=["getStaticFragment","getRecommendFragment","getStructureFragment"],r={getStaticFragment:"static",getRecommendFragment:"recommend",getStructureFragment:"struct"};n.transferV3.forEach((function(e){c.includes(e[2])&&i.push({chipId:e[3],chipType:r[e[2]],chipData:{name:e[0].split(":")[0],title:e[0].split(":")[1]||e[0].split(":")[0]}})})),e.setState({splitChip:a,allDataChip:i,isConflictReady:!0})},e}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.dataMap;u.g.skipHello();var n=document.getElementById("app"),a=window.innerWidth,i=window.innerHeight-48,c=new u.a({width:a,height:i,antialias:!0,transparent:!0,resolution:1});if(c.stage.interactive=!0,c.stage.hitArea=new u.c(0,0,a,i),c.renderer.view.style.position="absolute",c.renderer.view.style.top="0",c.renderer.view.style.left="0",c.renderer.view.style.zIndex="3",t.bc.image){var r=u.f.from(t.bc.image),s=new u.d(r);s.name="bc",s.zIndex=-1,c.stage.addChild(s)}var o=u.f.from("https://i1.letvimg.com/lc14_lemf/202311/28/10/15/Snipaste_2023-11-28_10-14-36.png"),l=new u.d(o);l.name="bc",l.zIndex=-1,c.stage.addChild(l),c.stage.sortableChildren=!0,n.appendChild(c.view),window.app=c,window.addEventListener("message",this.receiveMessage,!1),document.addEventListener("keydown",this.keyEvent,!1),document.addEventListener("wheel",B,!1),window.onbeforeunload=function(t){(0===e.props.env.indexOf("custom")||e.props.dataMap.children.length>0)&&(t.returnValue=!1)}}},{key:"componentWillUnmount",value:function(){var e=window.app;document.removeEventListener("keydown",this.keyEvent,!1),document.removeEventListener("wheel",B,!1),e.stage.removeAllListeners()}},{key:"render",value:function(){var e=this.state,t=e.isConflictReady,n=e.splitChip,a=e.allDataChip,i=this.props.isFreeze;return Object(w.jsxs)(Dn,{children:[Object(w.jsx)(st,{}),Object(w.jsxs)("div",{className:"main",children:[Object(w.jsx)("div",{className:"operate",id:"app",children:Object(w.jsx)(Mn,{})}),Object(w.jsx)("div",{className:"data",children:Object(w.jsx)(kn,{})}),t&&Object(w.jsx)(Nn,{splitChip:n,allDataChip:a}),i&&Object(w.jsx)("div",{className:"freeze"})]})]})}}]),n}(a.PureComponent);var _n=Object(s.b)((function(e){return{env:e.env,mode:e.mode,scale:e.scale,activeId:e.activeId,parentId:e.parentId,dataMap:e.dataMap,isFreeze:e.isFreeze}}))(En);n(520),n(521);r.a.render(Object(w.jsx)(s.a,{store:X,children:Object(w.jsx)(_n,{})}),document.getElementById("root"))}},[[522,1,2]]]);
//# sourceMappingURL=main.c070ec62.chunk.js.map